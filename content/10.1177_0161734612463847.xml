<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">UIX</journal-id>
<journal-id journal-id-type="hwp">spuix</journal-id>
<journal-title>Ultrasonic Imaging</journal-title>
<issn pub-type="ppub">0161-7346</issn>
<issn pub-type="epub">XXXX-XXXX</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage CA: Los Angeles, CA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0161734612463847</article-id>
<article-id pub-id-type="publisher-id">10.1177_0161734612463847</article-id>
<title-group>
<article-title>Rapid Transient Pressure Field Computations in the Nearfield of Circular Transducers Using Frequency-Domain Time-Space Decomposition</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Alles</surname><given-names>E. J.</given-names></name>
<xref ref-type="aff" rid="aff1-0161734612463847">1</xref>
<xref ref-type="aff" rid="aff2-0161734612463847">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Zhu</surname><given-names>Y.</given-names></name>
<xref ref-type="aff" rid="aff1-0161734612463847">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>van Dongen</surname><given-names>K. W. A.</given-names></name>
<xref ref-type="aff" rid="aff2-0161734612463847">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>McGough</surname><given-names>R. J.</given-names></name>
<xref ref-type="aff" rid="aff1-0161734612463847">1</xref>
</contrib>
</contrib-group>
<aff id="aff1-0161734612463847"><label>1</label>Department of Electrical and Computer Engineering, Michigan State University, USA</aff>
<aff id="aff2-0161734612463847"><label>2</label>Faculty of Applied Sciences, Delft University of Technology, Netherlands</aff>
<author-notes>
<corresp id="corresp1-0161734612463847">R. J. McGough, Department of Electrical and Computer Engineering, 2120 Engineering Building, 428 S. Shaw Lane, Michigan State University, East Lansing, MI 48824, USA Email: <email>mcgough@egr.msu.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>10</month>
<year>2012</year>
</pub-date>
<volume>34</volume>
<issue>4</issue>
<fpage>237</fpage>
<lpage>260</lpage>
<permissions>
<copyright-statement>© Author(s) 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>The fast nearfield method, when combined with time-space decomposition, is a rapid and accurate approach for calculating transient nearfield pressures generated by ultrasound transducers. However, the standard time-space decomposition approach is only applicable to certain analytical representations of the temporal transducer surface velocity that, when applied to the fast nearfield method, are expressed as a finite sum of products of separate temporal and spatial terms. To extend time-space decomposition such that accelerated transient field simulations are enabled in the nearfield for an arbitrary transducer surface velocity, a new transient simulation method, frequency-domain time-space decomposition (FDTSD), is derived. With this method, the temporal transducer surface velocity is transformed into the frequency domain, and then each complex-valued term is processed separately. Further improvements are achieved by spectral clipping, which reduces the number of terms and the computation time. Trade-offs between speed and accuracy are established for FDTSD calculations, and pressure fields obtained with the FDTSD method for a circular transducer are compared with those obtained with Field II and the impulse response method. The FDTSD approach, when combined with the fast nearfield method and spectral clipping, consistently achieves smaller errors in less time and requires less memory than Field II or the impulse response method.</p>
</abstract>
<kwd-group>
<kwd>circular transducer</kwd>
<kwd>transient pressure</kwd>
<kwd>fast near field method</kwd>
<kwd>time-space decomposition</kwd>
<kwd>impulse response</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0161734612463847" sec-type="intro">
<title>Introduction</title>
<p>As applications of diagnostic ultrasound that repeatedly process increasing amounts of radio-frequency signals and/or image data are developed, corresponding improvements in the performance of computer simulations are required. When the duration of the transient signals, number of images simulated, or the size of the computational grid increases, the computation times and memory requirements for these simulations expand accordingly. In these simulations, algorithm efficiency is especially important for large computations of transient pressures generated by ultrasound transducer arrays with a significant nearfield component. To address these issues, faster simulation algorithms that achieve equal or better accuracies in the near field region are needed. Ideally, these simulations should also be more memory efficient to enable simulations of even larger problems.</p>
<p>Although several different algorithms are available for nearfield transient simulations of pressures generated by ultrasound transducers and phased arrays, only a few of these are routinely applied to simulations of ultrasound imaging. For example, the Rayleigh-Sommerfeld integral,<sup><xref ref-type="bibr" rid="bibr1-0161734612463847">1</xref></sup> when applied to transient calculations in the nearfield, demonstrates a relatively slow rate of convergence and long computation times. The more popular approaches for simulating transient nearfield pressures, particularly for diagnostic ultrasound, typically utilize the impulse response method.<sup><xref ref-type="bibr" rid="bibr2-0161734612463847">2</xref></sup> Closed-form expressions are available for the impulse response in the nearfield region for circular,<sup><xref ref-type="bibr" rid="bibr3-0161734612463847">3</xref></sup> rectangular,<sup><xref ref-type="bibr" rid="bibr4-0161734612463847">4</xref>,<xref ref-type="bibr" rid="bibr5-0161734612463847">5</xref></sup> triangular,<sup><xref ref-type="bibr" rid="bibr6-0161734612463847">6</xref></sup> and spherically focused transducer geometries.<sup><xref ref-type="bibr" rid="bibr7-0161734612463847">7</xref><xref ref-type="bibr" rid="bibr8-0161734612463847"/><xref ref-type="bibr" rid="bibr9-0161734612463847"/>-<xref ref-type="bibr" rid="bibr10-0161734612463847">10</xref></sup> In the farfield region, a closed-form impulse response expression is also available for rectangular transducers.<sup><xref ref-type="bibr" rid="bibr11-0161734612463847">11</xref></sup> For transient nearfield calculations, once the impulse response for a single transducer or an array of transducers is evaluated, the result is convolved in time with the temporal derivative of the input signal and then multiplied by the density to obtain the pressure. Advantages of the impulse response approach include existing closed-form expressions for the impulse response for common transducer geometries and subsequent evaluation of the temporal convolution with the fast Fourier transform (FFT). These advantages generally translate into shorter computation times relative to the Rayleigh-Sommerfeld integral. The primary disadvantages of the impulse response are the sharp edges and infinite slopes that are inherently aliased when the impulse response is sampled in the time domain. These sharp edges and infinite slopes require high temporal sampling rates to reduce the effects of aliasing, and increasing the temporal sampling rate in turn reduces the efficiency of the impulse response method. Efforts to circumvent this aliasing problem include the smoothed impulse response<sup><xref ref-type="bibr" rid="bibr12-0161734612463847">12</xref></sup> and a conservation of energy approach.<sup><xref ref-type="bibr" rid="bibr13-0161734612463847">13</xref></sup> Another approach, namely, the fast nearfield method,<sup><xref ref-type="bibr" rid="bibr14-0161734612463847">14</xref>,<xref ref-type="bibr" rid="bibr15-0161734612463847">15</xref></sup> effectively avoids the problems with the Rayleigh-Sommerfeld integral and the impulse response with an analytically equivalent expression that converges faster in the nearfield than either of these methods. For transient simulations in the nearfield region, the fast nearfield method is combined with time-space decomposition<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref></sup> to accelerate these calculations. Although the fast nearfield method combined with time-space decomposition is faster, more accurate, and more memory efficient than the Rayleigh-Sommerfeld integral or the impulse response, the time-space decomposition approach is presently limited to only a few transient input signal representations.</p>
<p>Available programs for calculating linear nearfield pressures with these simulation methods include UltraSim (<ext-link ext-link-type="uri" xlink:href="http://www.mn.uio.no/ifi/english/research/groups/dsb/resources/software/ultrasim/index.html">http://www.mn.uio.no/ifi/english/research/groups/dsb/resources/software/ultrasim/index.html</ext-link>), DREAM (<ext-link ext-link-type="uri" xlink:href="http://www.signal.uu.se/Toolbox/dream/">http://www.signal.uu.se/Toolbox/dream/</ext-link>), Field II (<ext-link ext-link-type="uri" xlink:href="http://field-ii.dk/">http://field-ii.dk/</ext-link>), and FOCUS (<ext-link ext-link-type="uri" xlink:href="http://www.egr.msu.edu/~fultras-web/">http://www.egr.msu.edu/~fultras-web/</ext-link>). UltraSim<sup><xref ref-type="bibr" rid="bibr17-0161734612463847">17</xref><xref ref-type="bibr" rid="bibr18-0161734612463847"/><xref ref-type="bibr" rid="bibr19-0161734612463847"/>-<xref ref-type="bibr" rid="bibr20-0161734612463847">20</xref></sup> is a simulation package that computes the transient pressure field using the Rayleigh-Sommerfeld integral for planar and nearly planar transducers. UltraSim includes some preprogrammed transducer and array geometries, including rectangular, curved, and annular arrays. The DREAM<sup><xref ref-type="bibr" rid="bibr21-0161734612463847">21</xref><xref ref-type="bibr" rid="bibr22-0161734612463847"/><xref ref-type="bibr" rid="bibr23-0161734612463847"/><xref ref-type="bibr" rid="bibr24-0161734612463847"/>-<xref ref-type="bibr" rid="bibr25-0161734612463847">25</xref></sup> simulation package computes the time-domain impulse response for certain transducer shapes and arrays of these transducers, including focused and unfocused circular and rectangular geometries. DREAM evaluates a two-dimensional spatial integral, and the transient pressure field is computed by convolving the impulse response with the excitation function. The Field II program<sup><xref ref-type="bibr" rid="bibr26-0161734612463847">26</xref><xref ref-type="bibr" rid="bibr28-0161734612463847"/>-<xref ref-type="bibr" rid="bibr29-0161734612463847">29</xref></sup> subdivides the transducer surface into small rectangular subelements and then superposes the farfield impulse responses before temporally convolving the result with the input signal. Field II maintains the total energy in the impulse response to improve the numerical error and reduce the computation time for a given temporal sampling rate. For simulations of continuous wave pressures, the FOCUS software package uses the fast nearfield method<sup><xref ref-type="bibr" rid="bibr14-0161734612463847">14</xref>,<xref ref-type="bibr" rid="bibr15-0161734612463847">15</xref></sup> combined with the angular spectrum approach,<sup><xref ref-type="bibr" rid="bibr30-0161734612463847">30</xref>,<xref ref-type="bibr" rid="bibr31-0161734612463847">31</xref></sup> and for transient calculations, FOCUS combines the fast nearfield method<sup><xref ref-type="bibr" rid="bibr14-0161734612463847">14</xref>,<xref ref-type="bibr" rid="bibr15-0161734612463847">15</xref></sup> with time-space decomposition.<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref>,<xref ref-type="bibr" rid="bibr32-0161734612463847">32</xref></sup> FOCUS presently supports circular, rectangular, and spherically focused transducers and arrays of these transducers. Each program has advantages and disadvantages, and the disadvantages in particular motivate the development of improved transient nearfield simulation methods.</p>
<p>To address the main limitation of time-space decomposition for transient pressure calculations with the fast nearfield method, the time-space decomposition approach is extended to enable calculations with any temporally discretized signal. This is achieved by first evaluating the discrete Fourier transform (DFT) of the transducer surface velocity, which provides the input to a modified complex-valued time-space decomposition algorithm. With this approach, the benefits of the fast nearfield method combined with time-space decomposition, namely, high numerical accuracy, short computation times, and efficient utilization of computer memory, are achieved for any temporally discretized transducer surface velocity. After overviews of the impulse response method, the fast nearfield method, and time-space decomposition are given, the new frequency-domain time-space decomposition (FDTSD) algorithm is introduced, and other details of the computational methods are described. Then, the accuracy and efficiency of the FDTSD method, the impulse response method, and Field II are evaluated by comparing transient pressure fields of each method with a reference pressure field. The results show that the FDTSD algorithm combined with the fast nearfield method and spectral clipping consistently achieves smaller errors in less time and with less memory than the impulse response method or Field II.</p>
</sec>
<sec id="section2-0161734612463847">
<title>Pressure Field Computations</title>
<p><xref ref-type="fig" rid="fig1-0161734612463847">Figure 1</xref> shows a flat, circular transducer of radius <italic>a</italic> centered at the origin in the <italic>z</italic> = 0 plane. The distance between a source point on the transducer surface (<italic>x</italic>′,<italic>y</italic>′) and an observation point (<italic>r,z</italic>) is denoted by <italic>R</italic>, where the source coordinates are defined in Cartesian space, and the observation coordinates are in axisymmetric cylindrical coordinates. Due to the symmetry of the circular transducer centered in the cylindrical coordinate system, the angular dependence of the pressure field drops out, and observation points are described using only the radial coordinate <italic>r</italic> and axial coordinate <italic>z</italic>.</p>
<fig id="fig1-0161734612463847" position="float">
<label>Figure 1.</label>
<caption>
<p>Cartesian and cylindrical coordinate systems defined for a circular transducer with radius <italic>a</italic>, where (<italic>x</italic>′,<italic>y</italic>′) describes a point on the transducer surface in Cartesian space, and (<italic>r,z</italic>) describes an observation point in axisymmetric cylindrical coordinates with <inline-formula id="inline-formula1-0161734612463847">
<mml:math display="inline" id="math1-0161734612463847">
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mi>x</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>y</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:math>
</inline-formula>.</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig1.tif"/></fig>
<p>The transducer geometry and coordinate systems shown in <xref ref-type="fig" rid="fig1-0161734612463847">Figure 1</xref> are defined for transient pressure calculations using the impulse response, Field II, standard time-space decomposition combined with the fast nearfield method, and FDTSD combined with the fast nearfield method. All of the simulations with these methods are evaluated in a linear, homogeneous medium. The medium defined for these simulations is also nonattenuating with a frequency-independent speed of sound.</p>
<sec id="section3-0161734612463847">
<title>Impulse Response Method</title>
<p>The transient pressure generated by a transducer in the nearfield region, when computed with the impulse response,<sup><xref ref-type="bibr" rid="bibr4-0161734612463847">4</xref>,<xref ref-type="bibr" rid="bibr11-0161734612463847">11</xref></sup> is given by</p>
<p>
<disp-formula id="disp-formula1-0161734612463847">
<mml:math display="block" id="math2-0161734612463847">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>∗</mml:mo>
<mml:mi>h</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0161734612463847" xlink:href="10.1177_0161734612463847-eq1.tif"/></disp-formula>
</p>
<p>where <italic>p</italic>(<italic>r, z, t</italic>) is the pressure, ρ<sub>0</sub> is the homogeneous density, <inline-formula id="inline-formula2-0161734612463847">
<mml:math display="inline" id="math3-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is the temporal derivative of the normal component of the transducer surface velocity, the “∗” operator represents temporal convolution, and <italic>h</italic>(<italic>r, z, t</italic>) is the impulse response of the velocity potential. In (1), the normal component of the transducer surface velocity represented by <italic>v</italic>(<italic>t</italic>) is spatially uniform within the transducer radius <italic>a</italic>. For a circular transducer of radius <italic>a</italic>, the impulse response <italic>h</italic>(<italic>r, z, t</italic>) of the velocity potential is given by<sup><xref ref-type="bibr" rid="bibr4-0161734612463847">4</xref></sup></p>
<p>
<disp-formula id="disp-formula2-0161734612463847">
<mml:math display="block" id="math4-0161734612463847">
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mrow>
<mml:mtable columnalign="left">
<mml:mtr columnalign="left">
<mml:mtd columnalign="left">
<mml:mi>c</mml:mi>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>≤</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>&lt;</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:mi>r</mml:mi>
<mml:mo>&lt;</mml:mo>
<mml:mi>a</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr columnalign="left">
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mfrac>
<mml:mi>c</mml:mi>
<mml:mi>π</mml:mi>
</mml:mfrac>
<mml:msub>
<mml:mi>Ω</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>≤</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:mo>∀</mml:mo>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr columnalign="left">
<mml:mtd columnalign="left">
<mml:mn>0</mml:mn>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mtext>otherwise</mml:mtext>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0161734612463847" xlink:href="10.1177_0161734612463847-eq2.tif"/></disp-formula>
</p>
<p>where</p>
<p>
<disp-formula id="disp-formula3-0161734612463847">
<mml:math display="block" id="math5-0161734612463847">
<mml:mrow>
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>c</mml:mi>
<mml:mn>,</mml:mn>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mi>z</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>c</mml:mi>
<mml:mn>,</mml:mn>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mi>z</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>c</mml:mi>
<mml:mn>,</mml:mn>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0161734612463847" xlink:href="10.1177_0161734612463847-eq3.tif"/></disp-formula>
</p>
<p>and</p>
<p>
<disp-formula id="disp-formula4-0161734612463847">
<mml:math display="block" id="math6-0161734612463847">
<mml:mrow>
<mml:msub>
<mml:mi>Ω</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtext>acos</mml:mtext>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:msup>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mi>z</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>r</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mi>a</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>r</mml:mi>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mi>c</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:msup>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mi>z</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0161734612463847" xlink:href="10.1177_0161734612463847-eq4.tif"/></disp-formula>
</p>
<p>Transient pressure calculations with the impulse response method require high temporal sampling rates due to the discontinuities and infinite slopes in <italic>h</italic>(<italic>r, z, t</italic>).</p>
</sec>
<sec id="section4-0161734612463847">
<title>Field II</title>
<p>The Field II<sup><xref ref-type="bibr" rid="bibr13-0161734612463847">13</xref>,<xref ref-type="bibr" rid="bibr26-0161734612463847">26</xref></sup> ultrasound simulation software performs transient pressure field calculations either with a farfield approximation for rectangular subelements or with a nearfield expression that represents the transducer surface with triangles. In practice, most Field II simulations use rectangular subelements because longer computation times are often observed with triangles for a given numerical error. Despite the inevitable stair-step approximation that occurs when rectangles approximate circular or curved objects, Field II routinely calculates pressure fields and impulse responses for circular transducers using rectangular subelements.<sup><xref ref-type="bibr" rid="bibr33-0161734612463847">33</xref><xref ref-type="bibr" rid="bibr34-0161734612463847"/><xref ref-type="bibr" rid="bibr35-0161734612463847"/>-<xref ref-type="bibr" rid="bibr36-0161734612463847">36</xref></sup> To facilitate these calculations for circular transducers, Field II provides the “xdc_piston” routine.<sup><xref ref-type="bibr" rid="bibr37-0161734612463847">37</xref></sup> For sufficiently small rectangular subelements and for a sufficiently high temporal sampling rate, this approach is applicable to nearfield pressure calculations.</p>
</sec>
<sec id="section5-0161734612463847">
<title>Fast Nearfield Method</title>
<p>The fast nearfield method subtracts a singularity from the integrand of a rapidly converging one-dimensional integral, thereby eliminating the need for high temporal sampling rates while achieving relatively small numerical errors. The fast nearfield method<sup><xref ref-type="bibr" rid="bibr14-0161734612463847">14</xref>,<xref ref-type="bibr" rid="bibr15-0161734612463847">15</xref></sup> computes the transient pressure field generated by a circular transducer<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref></sup> with</p>
<p>
<disp-formula id="disp-formula5-0161734612463847">
<mml:math display="block" id="math7-0161734612463847">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mi>c</mml:mi>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mi>π</mml:mi>
</mml:mfrac>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mn>0</mml:mn>
<mml:mi>π</mml:mi>
</mml:munderover>
</mml:mrow>
</mml:mstyle>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>ϕ</mml:mi>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0161734612463847" xlink:href="10.1177_0161734612463847-eq5.tif"/></disp-formula>
</p>
<p>where</p>
<p>
<disp-formula id="disp-formula6-0161734612463847">
<mml:math display="block" id="math8-0161734612463847">
<mml:mrow>
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mi>cos</mml:mi>
<mml:mi>ϕ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mi>r</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>a</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>a</mml:mi>
<mml:mi>r</mml:mi>
<mml:mi>cos</mml:mi>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mi>r</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>a</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>a</mml:mi>
<mml:mi>r</mml:mi>
<mml:mi>cos</mml:mi>
<mml:mi>ϕ</mml:mi>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>z</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>c</mml:mi>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo>.</mml:mo>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0161734612463847" xlink:href="10.1177_0161734612463847-eq6.tif"/></disp-formula>
</p>
<p>In (5), φ is the variable of integration, and the <italic>M<sub>a</sub></italic>(<italic>r</italic>, φ) term is the kernel function of the fast nearfield method for a circular transducer. The variables τ<sub>1</sub> and τ<sub>2</sub> are delay times that depend on the integration variable φ and the spatial variables <italic>r</italic> and <italic>z</italic>. When combined with time-space decomposition, the rapid convergence and efficient memory usage of the fast nearfield method are retained while the computation time is significantly reduced.</p>
</sec>
<sec id="section6-0161734612463847">
<title>Time-Space Decomposition</title>
<p><xref ref-type="disp-formula" rid="disp-formula5-0161734612463847">Equations (5)</xref> and <xref ref-type="disp-formula" rid="disp-formula6-0161734612463847">(6)</xref> show that the kernel function <italic>M<sub>a</sub></italic>(<italic>r</italic>, φ) for a circular transducer is independent of time, whereas the expressions <italic>v</italic>(<italic>t</italic> − τ<sub>1</sub>) and <italic>v</italic>(<italic>t</italic> − τ<sub>2</sub>) for the delayed normal surface velocity are functions of both time and space. The time dependence of the delayed normal surface velocity is represented by the variable <italic>t</italic>, and the spatial dependence is captured by the expressions for τ<sub>1</sub> and τ<sub>2</sub> defined in (6). Time-space decomposition is applicable to any delayed signal <italic>v</italic>(<italic>t</italic> − τ) that is analytically represented by</p>
<p>
<disp-formula id="disp-formula7-0161734612463847">
<mml:math display="block" id="math9-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
</mml:mstyle>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>τ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0161734612463847" xlink:href="10.1177_0161734612463847-eq7.tif"/></disp-formula>
</p>
<p>where <italic>N</italic> is a small integer for most signals of interest and <italic>W</italic> is the temporal width of the pulse. In (7), rect(<italic>x</italic>) = 1 for 0 ≤ <italic>x</italic> ≤ 1 and 0 otherwise. The functions <italic>g<sub>n</sub></italic>(<italic>t</italic>) and <italic>f<sub>n</sub></italic>(τ) depend exclusively on time through the variable <italic>t</italic> and space through the variable τ, respectively. Analytical expressions for <italic>g<sub>n</sub></italic>(<italic>t</italic>) and <italic>f<sub>n</sub></italic>(τ) are obtained through algebraic manipulation of <italic>v</italic>(<italic>t</italic> − τ<sub>1</sub>) using trigonometric sum and difference formulas, exponentiation formulas, and binomial expansions.</p>
<p>Using the time-space decomposition<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref></sup> described in (7), (5) is converted into</p>
<p>
<disp-formula id="disp-formula8-0161734612463847">
<mml:math display="block" id="math10-0161734612463847">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mi>c</mml:mi>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mi>π</mml:mi>
</mml:mfrac>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:munderover>
</mml:mstyle>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>D</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0161734612463847" xlink:href="10.1177_0161734612463847-eq8.tif"/></disp-formula>
</p>
<p>with</p>
<p>
<disp-formula id="disp-formula9-0161734612463847">
<mml:math display="block" id="math11-0161734612463847">
<mml:mrow>
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>E</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mn>0</mml:mn>
<mml:mi>π</mml:mi>
</mml:munderover>
</mml:mrow>
</mml:mstyle>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mspace width="0.5em"/>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>τ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>ϕ</mml:mi>
<mml:mo>,</mml:mo>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mi>D</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mn>0</mml:mn>
<mml:mi>π</mml:mi>
</mml:munderover>
</mml:mrow>
</mml:mstyle>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>a</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>d</mml:mi>
<mml:mi>ϕ</mml:mi>
<mml:mo>.</mml:mo>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0161734612463847" xlink:href="10.1177_0161734612463847-eq9.tif"/></disp-formula>
</p>
<p>Since <italic>M<sub>a</sub></italic>(<italic>r</italic>, φ) and <italic>f<sub>n</sub></italic>(τ) in (9) are independent of time, time-space decomposition evaluates rapidly converging one-dimensional integrals at every point in space, whereas the fast nearfield method without time-space decomposition evaluates rapidly converging integrals at every point in both space and time. This facilitates a significant reduction in the computation time without increasing the numerical error or the computer memory required for these calculations.<sup><xref ref-type="bibr" rid="bibr32-0161734612463847">32</xref></sup> Time-space decompositions are implemented in FOCUS for three different signal types: a tone burst, a Hanning-weighted pulse, and a polynomial-weighted, exponentially damped broadband pulse.<sup><xref ref-type="bibr" rid="bibr38-0161734612463847">38</xref></sup> The explicit formulas for time-space decomposition calculations with a Hanning-weighted pulse are given in Chen and McGough<sup><xref ref-type="bibr" rid="bibr32-0161734612463847">32</xref></sup> and Chen et al.<sup><xref ref-type="bibr" rid="bibr39-0161734612463847">39</xref></sup></p>
</sec>
</sec>
<sec id="section7-0161734612463847">
<title>FDTSD</title>
<p>As demonstrated in Kelly and McGough,<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref></sup> the fast nearfield method combined with standard time-space decomposition is generally faster, more accurate, and more memory efficient than other transient nearfield calculation methods, but the standard time-space decomposition approach is limited to only delayed transducer surface velocities <italic>v</italic>(<italic>t</italic> − τ) that admit analytical representations of the form given in (7). Expressions that are incompatible with standard time-space decomposition contain square roots and other noninteger powers of (<italic>t</italic> − τ) as well as Gaussians and other exponential functions with arguments containing powers of (<italic>t</italic> − τ) other than one. For example, when a Gaussian of the form <inline-formula id="inline-formula3-0161734612463847">
<mml:math display="inline" id="math12-0161734612463847">
<mml:mrow>
<mml:msup>
<mml:mi>e</mml:mi>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
</inline-formula> is expanded, the resulting expression contains a cross term <italic>e</italic><sup>2<italic>t</italic>τ</sup> that prevents factorization into separate functions of <italic>t</italic> and τ. To enable rapid, accurate, and memory efficient transient pressure calculations for these and other signal representations, an alternative to the standard time-space decomposition approach is needed.</p>
<sec id="section8-0161734612463847">
<title>Derivation</title>
<p>To extend the capabilities of time-space decomposition, a new FDTSD method is derived for <italic>any</italic> discretized transducer surface velocity. This is achieved by first representing the transducer surface velocity <italic>v</italic>(<italic>t</italic>) as a frequency-domain signal using a discrete Fourier transform.<sup><xref ref-type="bibr" rid="bibr40-0161734612463847">40</xref></sup> The FDTSD expression for this frequency-domain signal is then obtained from the inverse discrete Fourier transform, which is defined as</p>
<p>
<disp-formula id="disp-formula10-0161734612463847">
<mml:math display="block" id="math13-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munderover>
</mml:mstyle>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mi>j</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0161734612463847" xlink:href="10.1177_0161734612463847-eq10.tif"/></disp-formula>
</p>
<p>for <italic>k</italic> = 1, . . . , <italic>N<sub>t</sub></italic>, where <inline-formula id="inline-formula4-0161734612463847">
<mml:math display="inline" id="math14-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is a sampled frequency-domain signal with <italic>n</italic> = 1, . . . , <italic>N<sub>t</sub></italic>. After substituting <italic>k</italic> − 1= <italic>f<sub>s</sub>t<sub>k</sub></italic>, n − 1 = <italic>f<sub>n</sub></italic>/Δ<italic>f</italic> = <italic>f<sub>n</sub>N<sub>t</sub></italic>/<italic>f<sub>s</sub>, v</italic>[<italic>k</italic>] = <italic>v</italic>(<italic>t<sub>k</sub></italic>), and <inline-formula id="inline-formula5-0161734612463847">
<mml:math display="inline" id="math15-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>=</mml:mo>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>, (10) becomes</p>
<p>
<disp-formula id="disp-formula11-0161734612463847">
<mml:math display="block" id="math16-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munderover>
</mml:mstyle>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0161734612463847" xlink:href="10.1177_0161734612463847-eq11.tif"/></disp-formula>
</p>
<p>where <italic>f<sub>s</sub></italic> is the sampling frequency, <italic>ω<sub>n</sub></italic> = 2π<italic>f<sub>n</sub></italic> is the angular frequency of the <italic>n</italic>th frequency component, <inline-formula id="inline-formula6-0161734612463847">
<mml:math display="inline" id="math17-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is the <italic>n</italic>th frequency component of the transducer surface velocity, <italic>v</italic>(<italic>t<sub>k</sub></italic>) is the <italic>k</italic>th time sample of the transducer surface velocity, and <italic>N<sub>t</sub></italic> is the number of time samples. Since the inverse discrete Fourier transform in (10) is periodic, replicas of the discretized transducer surface velocity are created with periodicity <italic>N<sub>t</sub></italic>. In (11), the rect(·) function removes the periodic replicas, and only the original <italic>v</italic>(<italic>t</italic>) that begins at <italic>t</italic><sub>1</sub> = 0 and ends at <italic>t<sub>Nt</sub></italic> = <italic>W</italic> = (<italic>N<sub>t</sub></italic> − 1)/<italic>f<sub>s</sub></italic> is retained.</p>
<p>Calculations with the fast nearfield method in (5) require the computation of <italic>v</italic>(<italic>t</italic> − τ). Replacing <italic>t<sub>k</sub></italic> with (<italic>t</italic> − τ) in (11) yields the expression</p>
<p>
<disp-formula id="disp-formula12-0161734612463847">
<mml:math display="block" id="math18-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munderover>
</mml:mstyle>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0161734612463847" xlink:href="10.1177_0161734612463847-eq12.tif"/></disp-formula>
</p>
<p>which is equivalent to the time-space decomposition expression in (7) with</p>
<p><disp-formula id="disp-formula13-0161734612463847">
<mml:math display="block" id="math19-0161734612463847">
<mml:mrow>
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>τ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>j</mml:mi>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mn>,</mml:mn>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>.</mml:mo>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-0161734612463847" xlink:href="10.1177_0161734612463847-eq13.tif"/></disp-formula>
</p>
<p>and <italic>N</italic> = <italic>N<sub>t</sub></italic>. By numerically evaluating the discrete Fourier transform of the delayed transducer surface velocity, <italic>v</italic>(<italic>t</italic> − τ) is decomposed into a finite number of unweighted and weighted complex exponential functions <italic>f<sub>n</sub></italic>(τ) and <italic>g<sub>n</sub></italic>(<italic>t</italic>), which only depend on τ or <italic>t</italic>, respectively. The FDTSD method yields a finite number of terms that, when superposed, produce an equivalent representation of the original delayed signal <italic>v</italic>(<italic>t</italic> − τ). In contrast to the standard time-space decomposition approach, the FDTSD method yields complex-valued functions <italic>f<sub>n</sub></italic>(τ) and <italic>g<sub>n</sub></italic>(<italic>t</italic>), and the value of <italic>N<sub>t</sub></italic> for FDTSD calculations is equal to the number of samples in the discretized signal representation. With the standard time-space decomposition approach, <italic>f<sub>n</sub></italic>(τ) and <italic>g<sub>n</sub></italic>(<italic>t</italic>) are strictly real, and the number of terms, <italic>N</italic>, is typically 2, 6, or 8. Furthermore, any discrete time representation of <italic>v</italic>(<italic>t</italic>) is applicable to the FDTSD algorithm, whereas only certain analytical signal representations are amenable to calculations with the standard time-space decomposition approach. Thus, with this new FDTSD algorithm, accelerated transient pressure calculations are enabled with the fast nearfield method for any temporally sampled normal surface velocity <italic>v</italic>(<italic>t</italic>).</p>
</sec>
<sec id="section9-0161734612463847">
<title>Spectral Clipping</title>
<p>The FDTSD algorithm, when combined with the fast nearfield method, computes transient pressure fields for any sampled transducer surface velocity while retaining the rapid convergence and memory efficiency of the fast nearfield method. However, the FDTSD method evaluates far more complex-valued terms, <italic>N<sub>t</sub></italic>, than the number of terms, <italic>N</italic>, that are typically calculated with the standard time-space decomposition approach. To reduce the number of complex-valued terms that are processed and further improve the efficiency of the FDTSD approach, some characteristics of the Fourier transform <inline-formula id="inline-formula7-0161734612463847">
<mml:math display="inline" id="math20-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>ω</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> are exploited. For example, since the Fourier transform satisfies <inline-formula id="inline-formula8-0161734612463847">
<mml:math display="inline" id="math21-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>ω</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>*</mml:mo>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>ω</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> for real-valued signals, only the complex-valued terms corresponding to nonnegative frequencies are used, and the terms corresponding to negative frequencies are discarded. Thus, the number of terms required is reduced by approximately a factor of two. A further decrease in the number of terms is achieved by utilizing the fact that typical transducer surface velocities are band-limited. The implication is that many of the complex-valued terms contain very little energy and thus contribute minimally to the computed transient pressure field.</p>
<p>To exploit these features of the transformed signal <inline-formula id="inline-formula9-0161734612463847">
<mml:math display="inline" id="math22-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>ω</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>, a spectral clipping approach is defined for FDTSD calculations. Spectral clipping defines a threshold value below which the signal contributions are insignificant. Below this threshold, the complex-valued terms are discarded, and only the terms above this threshold are processed by the FDTSD algorithm. Omitting these terms significantly reduces the computation time while increasing the numerical error by only a small amount.</p>
</sec>
<sec id="section10-0161734612463847">
<title>Computer Implementation</title>
<p>The FDTSD approach first evaluates the FFT of the discretized transducer surface velocity signal <italic>v</italic>(<italic>t</italic>). If spectral clipping is used, a threshold value is determined, and only the complex-valued terms with amplitudes above this threshold are retained. The remaining terms are discarded. The Fourier components <inline-formula id="inline-formula10-0161734612463847">
<mml:math display="inline" id="math23-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>n</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> with amplitudes above the threshold are applied to the expression for <italic>g<sub>n</sub></italic>(<italic>t</italic>) in (13), and the complex-valued <italic>f<sub>n</sub></italic>(τ) in (13) is applied to (9). The integrals in (9) are then evaluated with Gauss quadrature, and duplicate calculations with identical terms are avoided. Next, the complex product <italic>g<sub>n</sub></italic>(<italic>t</italic>)<italic>E<sub>n</sub></italic>(<italic>r, z, t</italic>) in (8) is calculated, each term with a corresponding negative frequency component is multiplied by 2, and the real part is extracted. The transient pressure is then obtained when the results of these calculations are inserted into (8). Thus, the FDTSD calculation procedure is initialized with a single forward FFT, and the remaining calculations are rapidly performed without any additional forward or inverse FFTs.</p>
</sec>
</sec>
<sec id="section11-0161734612463847" sec-type="methods">
<title>Methods</title>
<sec id="section12-0161734612463847">
<title>FFT-Based Impulse Response Calculations</title>
<p>The impulse response method is evaluated for reference calculations and for comparisons using FFTs. First, the duration of the transient pressure is determined from the sum of the durations of the normal surface velocity signal and the impulse response of the velocity potential. The time derivative of the normal surface velocity signal is then zero-padded to match the length of the computed transient pressure, and additional zero-padding is included as needed for radix-2 FFT calculations with the FFTW3 library.<sup><xref ref-type="bibr" rid="bibr41-0161734612463847">41</xref></sup> Next, the impulse response of the velocity potential is calculated in the time domain, zero-padded to equal the length of the zero-padded normal surface velocity signal, and then the FFT of the result is computed to obtain the frequency-domain transfer function for the velocity potential. The FFT of the input signal is then multiplied by the frequency-domain transfer function, and the inverse FFT is evaluated. The real part is extracted from the result, which is then multiplied by the density to obtain the transient pressure.</p>
</sec>
<sec id="section13-0161734612463847">
<title>Time-Space Decomposition and FDTSD Calculations with Gauss Quadrature</title>
<p>For time-space decomposition and FDTSD calculations, the integrals for <italic>E<sub>n</sub></italic>(<italic>r, z, t</italic>) and <italic>D</italic>(<italic>r</italic>) in (9) are computed using Gauss quadrature over the interval 0 ≤ φ ≤ π. The values of each term are evaluated at every spatial point, and then all of the contributions from each of the complex-valued terms except those removed by spectral clipping are combined in the time domain. Numerical solutions obtained when Gauss quadrature is applied to (5) and (9) converge very rapidly, as demonstrated in McGough et al.<sup><xref ref-type="bibr" rid="bibr14-0161734612463847">14</xref></sup> and Kelly and McGough.<sup><xref ref-type="bibr" rid="bibr16-0161734612463847">16</xref></sup></p>
</sec>
<sec id="section14-0161734612463847">
<title>Error Calculations</title>
<p>The normalized error in the transducer surface velocity, ε<sub><italic>v</italic></sub>, is defined as</p>
<p>
<disp-formula id="disp-formula14-0161734612463847">
<mml:math display="block" id="math24-0161734612463847">
<mml:mrow>
<mml:msub>
<mml:mi>ε</mml:mi>
<mml:mi>v</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-0161734612463847" xlink:href="10.1177_0161734612463847-eq14.tif"/></disp-formula>
</p>
<p>where <italic>v</italic>(<italic>t</italic>) is the original discretized transducer surface velocity signal with <italic>N<sub>t</sub></italic> samples and <inline-formula id="inline-formula11-0161734612463847">
<mml:math display="inline" id="math25-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is the time-domain representation of the decomposed signal with the clipped spectrum. In (14), the error is evaluated over the duration of the original signal. The normalized error in the pressure field, ε<sub><italic>p</italic></sub>, is given by</p>
<p>
<disp-formula id="disp-formula15-0161734612463847">
<mml:math display="block" id="math26-0161734612463847">
<mml:mrow>
<mml:msub>
<mml:mi>ε</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>r</mml:mi>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>p</mml:mi>
<mml:mrow>
<mml:mtext>ref</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>r</mml:mi>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
<mml:mn>,</mml:mn>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
</mml:munder>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>p</mml:mi>
<mml:mrow>
<mml:mtext>ref</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>r</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>z</mml:mi>
<mml:mn>,</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-0161734612463847" xlink:href="10.1177_0161734612463847-eq15.tif"/></disp-formula>
</p>
<p>where the error is evaluated over all samples in time <italic>N<sub>t</sub></italic> and space (<italic>N<sub>r</sub>, N<sub>z</sub></italic>), and the computed pressure field <italic>p</italic>(<italic>r, z, t</italic>) is evaluated relative to a reference pressure field <italic>p<sub>ref</sub></italic>(<italic>r, z, t</italic>) calculated with the impulse response method.</p>
</sec>
<sec id="section15-0161734612463847">
<title>Transducer Surface Velocities</title>
<p>For transient pressure field simulations, one analytical representation for the normal component of the transducer surface velocity is given by a Hanning-weighted sinusoidal pulse,</p>
<p>
<disp-formula id="disp-formula16-0161734612463847">
<mml:math display="block" id="math27-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:mfrac>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mi>sin</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mi>t</mml:mi>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-0161734612463847" xlink:href="10.1177_0161734612463847-eq16.tif"/></disp-formula>
</p>
<p>where <italic>f</italic><sub>0</sub> is the center frequency in Hz, <italic>A</italic><sub>0</sub> is the amplitude in m/s, and <italic>W</italic> is the temporal duration of the pulse. Another analytical representation is given by a Gaussian-modulated sinusoidal pulse,</p>
<p><disp-formula id="disp-formula17-0161734612463847">
<mml:math display="block" id="math28-0161734612463847">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msup>
<mml:mi>σ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mi>sin</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>rect</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mi>t</mml:mi>
<mml:mi>W</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mn>,</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-0161734612463847" xlink:href="10.1177_0161734612463847-eq17.tif"/>
</disp-formula></p>
<p>where <italic>t</italic><sub>0</sub> and σ are the offset and standard deviation of the envelope, respectively. Analytical time-space decomposition is readily achieved for the Hanning-weighted pulse, but the square of the time variable in the exponential function prevents analytical time-space decomposition of the Gaussian-modulated pulse. The signal representation in (16) provides the input for the transient nearfield pressure calculation methods evaluated in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>, and the signal representation in (17) provides the input for the calculation methods in evaluated in <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref>.</p>
</sec>
<sec id="section16-0161734612463847">
<title>Computer Simulations</title>
<p>All simulations are performed on a single core of an AMD Phenom 2.60-GHz quad-core desktop with 8 GB of RAM. Calculations with time-space decomposition are evaluated in FOCUS. For Field II calculations, v3.20 is used. The impulse response and FDTSD programs are written in C++ and compiled with the mingw compiler (<ext-link ext-link-type="uri" xlink:href="http://www.mingw.org/">http://www.mingw.org/</ext-link>). All programs are executed within the 32-bit version of MATLAB version R2010a.</p>
</sec>
</sec>
<sec id="section17-0161734612463847" sec-type="results">
<title>Results</title>
<sec id="section18-0161734612463847">
<title>Simulation Parameters</title>
<p>A circular transducer with radius <italic>a</italic> = 1 mm is modeled in these simulations. The spatial grids defined for transient pressure calculations are parallel planes located various distances from the transducer surface. Each plane consists of either 21 × 21 grid points spaced 200 µm apart or 51 × 51 grid points with 80-µm spacing. The coarser grid sampling is evaluated in comparisons of computation time, numerical error, and memory efficiency, and the denser grid is shown in the mesh plot that demonstrates the smooth variations in the computed transient pressure field. The value for the speed of sound in these simulations is <italic>c</italic> = 1500 m/s. The temporal sampling rate is 100 MHz. The center frequency of the signal <italic>v</italic>(<italic>t</italic>) in (16) and (17) is <italic>f</italic><sub>0</sub> = 5 MHz, the signal duration <italic>W</italic> is equal to four cycles at the center frequency, and the amplitude of the normal surface velocity is <italic>A</italic><sub>0</sub> = 1 m/s. The total extent of the temporal window for these calculations is defined such that the entire duration of the computed transient pressure is captured for all points in the computational grid. For a single point in space, this quantity is equal to the sum of the duration of the signal <italic>v</italic>(<italic>t</italic>) and the duration of the impulse response.</p>
</sec>
<sec id="section19-0161734612463847">
<title>Transient Pressure Field</title>
<p><xref ref-type="fig" rid="fig2-0161734612463847">Figure 2</xref> shows the simulated transient pressure field generated at time <italic>t</italic> = 2.8 µs by the circular transducer illustrated in <xref ref-type="fig" rid="fig1-0161734612463847">Figure 1</xref>. The transient pressure is computed in the <italic>z</italic> = 3 mm plane on a 51 × 51 grid with points spaced 80 µm apart. For this simulation, the normal surface velocity <italic>v</italic>(<italic>t</italic>) is given by the four-cycle Hanning-weighted pulse of (16), and the result is computed with the impulse response method. Only one quadrant is computed and shown because the field is symmetric about the origin. This pressure field is representative of the transient pressure fields computed in the following sections.</p>
<fig id="fig2-0161734612463847" position="float">
<label>Figure 2.</label>
<caption>
<p>Transient pressure field generated at time <italic>t</italic> = 2.8 µs by a circular transducer with radius <italic>a</italic> = 1 mm. The normal surface velocity is described by a four-cycle Hanning-weighted sinusoidal pulse with center frequency <italic>f</italic><sub>0</sub> = 5 MHz, and the transient pressure is computed with the impulse response method in the <italic>z</italic> = 3 mm plane.</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig2.tif"/></fig>
</sec>
<sec id="section20-0161734612463847">
<title>FDTSD Calculations with a Hanning-Weighted Sinusoidal Pulse</title>
<sec id="section21-0161734612463847">
<title>Convergence of the numerical error</title>
<p>The numerical errors produced by the FDTSD approach combined with the fast nearfield method are computed in different planes, and the results are shown in <xref ref-type="fig" rid="fig3-0161734612463847">Figure 3</xref>. The errors, which are calculated relative to a reference transient pressure field obtained with the impulse response, are evaluated for transient pressures generated by a circular transducer calculated in 21 × 21 point spatial grids located at <italic>z</italic> = λ/2 =150 µm, <italic>z</italic> = 10λ = 3 mm, and <inline-formula id="inline-formula12-0161734612463847">
<mml:math display="inline" id="math29-0161734612463847">
<mml:mrow>
<mml:mi>z</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>333</mml:mn>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mn>3</mml:mn>
</mml:mfrac>
<mml:mi>λ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>10</mml:mn>
</mml:mrow>
</mml:math>
</inline-formula> cm. Transient pressures are calculated at 515 time points in the <italic>z</italic> = 150 µm plane, 368 time points in the <italic>z</italic> = 3 mm plane, and 97 time points in the <italic>z</italic> = 10 cm plane. These simulations are performed without spectral clipping to achieve the smallest possible errors with the FDTSD approach. In <xref ref-type="fig" rid="fig3-0161734612463847">Figure 3</xref>, the errors shown are computed with (15) and are plotted as a function of the number of abscissas defined for FDTSD calculations. In these calculations, the transducer surface velocity is described by the four-cycle Hanning-weighted pulse in (16). The impulse response reference field is computed with a sampling frequency of 500 GHz, which was selected based on computer memory constraints. The impulse response reference is then downsampled to 100 MHz prior to comparisons with the results of FDTSD calculations.</p>
<fig id="fig3-0161734612463847" position="float">
<label>Figure 3.</label>
<caption>
<p>Numerical errors ε<sub><italic>p</italic></sub> evaluated in three planes for frequency-domain time-space decomposition calculations without spectral clipping. The normal surface velocity is described by a four-cycle Hanning-weighted sinusoidal pulse with center frequency <italic>f</italic><sub>0</sub> = 5 MHz, and the reference field is computed with the impulse response. The error ε<sub><italic>p</italic></sub> in the simulated transient pressure field converges in all three planes (at <italic>z</italic> = 150 µm, <italic>z</italic> = 3 mm, and <italic>z</italic> = 10 cm) to the limiting value of the error in the impulse response reference. Faster rates of convergence are achieved at greater distances from the transducer, so fewer abscissas are required to achieve a specified error as the distance to the transducer increases.</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig3.tif"/></fig>
<p><xref ref-type="fig" rid="fig3-0161734612463847">Figure 3</xref> demonstrates that transient pressures simulated using the FDTSD approach combined with the fast nearfield method converge at different rates in planes evaluated at different axial distances. In <xref ref-type="fig" rid="fig3-0161734612463847">Figure 3</xref>, the convergence is fastest in the plane at <italic>z</italic> = 10 cm, and the convergence is slowest in the plane at <italic>z</italic> = 150 µm. For error calculations in each plane, the error reaches a limiting value that is approximately equal to the error in the impulse response reference. The source of the error was determined by calculating the errors in FDTSD calculations for impulse response references evaluated at different sampling frequencies, which showed that the limiting value changed as the sampling frequency of the impulse response reference changed. In <xref ref-type="fig" rid="fig3-0161734612463847">Figure 3</xref>, the limiting value of the error is ε<sub><italic>p</italic></sub> = 3.4·10<sup>−5</sup> in the plane at <italic>z</italic> = 150 µm, the limiting value of the error is ε<sub><italic>p</italic></sub> = 3.4·10<sup>−5</sup> in the plane at <italic>z</italic> = 3 mm, and the limiting value of the error is ε<sub><italic>p</italic></sub> = 3.8·10<sup>−5</sup> in the plane at <italic>z</italic> = 10 cm, which suggests that, for this example, the error in the impulse response reference remains approximately the same in these three planes as the distance from the transducer increases. For calculations in the plane at <italic>z</italic> = 150 µm, the error ε<sub><italic>p</italic></sub> = 3.4·10<sup>−5</sup> is achieved with 70 abscissas. The error ε<sub><italic>p</italic></sub> = 3.4·10<sup>−5</sup> is reached in the plane at <italic>z</italic> = 3 mm with 52 abscissas, and the error ε<sub><italic>p</italic></sub> = 3.8·10<sup>−5</sup> is reached in the plane at <italic>z</italic> = 10 cm with 7 abscissas. Thus, fewer abscissas are required for FDTSD calculations as the distance from the transducer increases.</p>
</sec>
<sec id="section22-0161734612463847">
<title>Characterization of spectral clipping</title>
<p>The effect of spectral clipping on the transducer surface velocity is demonstrated for a Hanning-weighted pulse in <xref ref-type="fig" rid="fig4-0161734612463847">Figure 4</xref>. The initial pulse, which is sampled at <italic>f</italic><sub>s</sub> = 100 MHz, is shown in the upper left hand panel, and the normalized spectrum is shown in the upper right panel. The plot of the normalized spectrum indicates that most of the magnitudes are well below the peak value. In this example, the threshold is −38 dB, which is indicated by a dashed line in the upper right panel. All complex-valued terms with magnitudes less than this threshold value are set to zero, then the inverse discrete Fourier transform is evaluated, and an approximation to the initial sampled pulse is obtained. The resulting reconstructed transducer surface velocity is shown in the lower right panel of <xref ref-type="fig" rid="fig4-0161734612463847">Figure 4</xref>. This result is obtained using the four complex-valued terms with magnitudes that exceed the −38 dB threshold, and the error is ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> relative to the initial sampled pulse. The original transducer surface velocity is represented by 81 time samples and 41 nonnegative complex-valued terms, so spectral clipping reduces the number of complex-valued terms required by about 90% in this example. In the bottom left panel, the error in the reconstructed pulse <inline-formula id="inline-formula13-0161734612463847">
<mml:math display="inline" id="math30-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is evaluated for different threshold values. For thresholds between −120 dB and 0 dB, the errors ε<sub><italic>v</italic></sub> in the reconstructed transducer surface velocity produced by spectral clipping are between 10<sup>−6</sup> and 10<sup>0</sup>. This plot also shows that −38 dB is the largest integer value for the spectral clipping threshold that produces an error ε<sub><italic>v</italic></sub> below 1% for this combination of pulse parameters.</p>
<fig id="fig4-0161734612463847" position="float">
<label>Figure 4.</label>
<caption>
<p>Spectral clipping applied to a Hanning-weighted sinusoidal pulse. In the top row, the original signal and the corresponding spectrum are shown. In the bottom left panel, the error ε<sub><italic>v</italic></sub> in the reconstructed signal <inline-formula id="inline-formula14-0161734612463847">
<mml:math display="inline" id="math31-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is plotted as function of the spectral clipping threshold in dB. In the bottom right panel, an example of a reconstructed signal <inline-formula id="inline-formula15-0161734612463847">
<mml:math display="inline" id="math32-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> with an error ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> is shown. Only the frequencies above the threshold of -38 dB indicated by the dashed line in the upper right panel are included in the reconstructed signal.</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig4.tif"/></fig>
<p>Transient pressure calculations with spectral clipping applied to FDTSD combined with the fast nearfield method also demonstrate a corresponding reduction in the computation time. When evaluated for a circular transducer with radius <italic>a</italic> = 1 mm in a coarse 21 × 21 mesh located in the <italic>z</italic> = 3 mm plane using 25 Gauss abscissas, spectral clipping applied to the Hanning-weighted pulse analyzed in <xref ref-type="fig" rid="fig4-0161734612463847">Figure 4</xref> reduces the computation time from 0.5472 seconds for FDTSD calculations with the initial pulse in the upper left panel to 0.07083 seconds with the approximate pulse in the lower right panel. This corresponds to a factor of 7.7 reduction in the computation time achieved with spectral clipping. Furthermore, the error in the simulated transient pressure field calculated with FDTSD and spectral clipping is only ε<sub><italic>p</italic></sub> = 4.7·10<sup>−3</sup>. When the transient pressures obtained from these FDTSD calculations with and without spectral clipping are plotted on a linear scale, the two results are nearly identical. Thus, by significantly decreasing the number of terms in the frequency-domain representation of <italic>v</italic>(<italic>t</italic>), spectral clipping facilitates a corresponding reduction in the computation time while maintaining the specified accuracy of the calculated transient nearfield pressure.</p>
</sec>
<sec id="section23-0161734612463847">
<title>Comparisons of computation times and numerical errors</title>
<p><xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> shows the relationship between the numerical errors and computation times for transient nearfield pressures calculated using FDTSD with spectral clipping, FDTSD without spectral clipping, standard time-space decomposition, the impulse response method, and Field II. In each simulation, transient pressures are calculated for a circular transducer with <italic>a</italic> = 1 mm, where the normal surface velocity is represented by a four-cycle Hanning-weighted pulse with a center frequency of <italic>f</italic><sub>0</sub> = 5 MHz. The transient pressures, which are evaluated at 368 time points, are computed on a coarse 21 × 21 point spatial grid located in the <italic>z</italic> = 3 mm plane. For each FDTSD and time-space decomposition simulation, the temporal sampling rate is 100 MHz, and the number of abscissas is varied from 5 to 80 in increments of 5. For Field II and impulse response simulations, the temporal sampling frequency is varied from 100 MHz to 50 GHz. The subelement sizes selected for Field II simulations are λ/15 × λ/15 and λ/54 × λ/54 at this center frequency (λ = 300 µm). For the subelement discretizations λ/(3<italic>n</italic>) considered here, where <italic>n</italic> is a positive integer, these are the largest respective subelements for which the asymptotic trends in the error ε<sub><italic>p</italic></sub> are consistently below 1% and 0.1% and for which the asymptotic trends in the error ε<sub><italic>p</italic></sub> are also consistently below 1% and 0.1% for all smaller subelements. In <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>, the horizontal axis describes the range of computation times on a logarithmic scale, and the vertical axis shows the range of numerical errors ε<sub><italic>p</italic></sub> on a logarithmic scale. When plotted on these axes, the faster methods, when compared for the same error, are on the left, and slower methods are on the right. Likewise, the more accurate results are closer to the bottom of this figure and the less accurate results are closer to the top of the figure.</p>
<fig id="fig5-0161734612463847" position="float">
<label>Figure 5.</label>
<caption>
<p>Numerical error ε<sub><italic>p</italic></sub> in the transient pressure field evaluated in the <italic>z</italic> = 3 mm plane plotted as a function of the computation time for several different simulation methods, where the transducer surface velocity applied to each simulation is described by a four-cycle Hanning-weighted sinusoidal pulse. Each result shown describes the reduction in the error ε<sub><italic>p</italic></sub> and the corresponding increase in the computation time as the number of abscissas increases from 5 to 80 (FDTSD with and without spectral clipping and standard time-space decomposition) or as the temporal sampling rate increases from 100 MHz to 50 GHz (Field II and the impulse response method). FDTSD = frequency-domain time-space decomposition; TSD = time-space decomposition.</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig5.tif"/></fig>
<p>Three different FDTSD results are shown in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>. The dash-dot line with diamond markers shows the numerical errors ε<sub><italic>p</italic></sub> and computation times for the FDTSD transient pressure calculation without spectral clipping. This result applies all of the complex-valued terms with nonnegative frequencies to the FDTSD calculation. The solid line with circle markers shows the numerical errors ε<sub><italic>p</italic></sub> and computation times for the FDTSD transient pressure calculation obtained when spectral clipping is applied to the transducer surface velocity pulse such that the error in the reconstructed pulse <inline-formula id="inline-formula16-0161734612463847">
<mml:math display="inline" id="math33-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup>. This value for the error ε<sub><italic>v</italic></sub> is obtained when the spectral clipping threshold is −38 dB. The dashed line with square markers shows the numerical errors in the transient pressure ε<sub><italic>p</italic></sub> and computation times obtained with the FDTSD calculation when spectral clipping is applied to the transducer face velocity pulse such that the error in the reconstructed pulse <inline-formula id="inline-formula17-0161734612463847">
<mml:math display="inline" id="math34-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is ε<sub><italic>v</italic></sub> = 8.1·10<sup>−4</sup>. This value for the error ε<sub><italic>v</italic></sub> is obtained when the threshold defined for FDTSD calculations with spectral clipping is −61 dB. The values ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> and ε<sub><italic>v</italic></sub> = 8.1·10<sup>−4</sup> were selected because these are the largest values of ε<sub><italic>v</italic></sub> below 1% and 0.1%, respectively, for the four-cycle Hanning-weighted pulse.</p>
<p>According to <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>, for the combination of parameters evaluated in this example, the ranking from fastest to slowest for a 1% error in the computed transient nearfield pressure is (a) standard time-space decomposition (dotted line with triangle markers), followed by (b) FDTSD with spectral clipping and a specified error in <inline-formula id="inline-formula18-0161734612463847">
<mml:math display="inline" id="math35-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> given by ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> (solid line with circle markers), (c) FDTSD with spectral clipping and a specified error in <inline-formula id="inline-formula19-0161734612463847">
<mml:math display="inline" id="math36-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> given by ε<sub><italic>v</italic></sub> = 10<sup>−3</sup> (dashed line with square markers), (d) FDTSD without spectral clipping (dash-dot line with diamond markers), (e) the impulse response (dotted line with + markers), then by a small margin (f) Field II with λ/15 × λ/15 subelements (solid line with × markers), and (g) Field II with λ/54 × λ/54 subelements (dashed line with * markers). Standard time-space decomposition achieves a specified error ε<sub><italic>p</italic></sub> in the computed transient nearfield pressure in less time than these other methods because only six real-valued terms are applied to the fast nearfield method expression in (5), which evaluates a well-behaved one-dimensional integral expression that avoids aliasing problems in the integrand. The next fastest results for a given error are obtained with the FDTSD algorithm, which also achieve rapid convergence with the fast nearfield method expression in (5). The relative speeds of the FDTSD calculations correspond to the number of terms evaluated, where FDTSD with spectral clipping and ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> evaluates 4 complex-valued terms, FDTSD with spectral clipping and ε<sub><italic>v</italic></sub> = 8.1·10<sup>−4</sup> evaluates 8 complex-valued terms, and FDTSD without spectral clipping calculates the result with the 41 complex-valued terms that correspond to nonnegative frequencies. These are followed in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> by the impulse response and the two results obtained with Field II. The impulse response method calculates the transient pressure with forward and inverse FFTs, but the temporal sampling rates that are required to achieve a given error are so high that the computational advantage of the FFT is lost. The longer computation times observed in the Field II simulations are most likely caused by the two-dimensional aperture sampling, the high temporal sampling rates, and the additional processing steps required for the conservation of energy approach.</p>
<p><xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> demonstrates the rate of convergence and the limiting error values for each simulation. Calculations that combine standard time-space decomposition with the fast nearfield method converge very rapidly, where the spacing between markers on the leftmost dotted line in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> corresponds to an increment of five Gauss abscissas. After a certain point, the reduction in error ε<sub><italic>p</italic></sub> diminishes as the number of abscissas increases before reaching the limit in the error calculation established by the impulse response reference. FDTSD without spectral clipping also converges to the limit in the error established by the impulse response reference. The minimum error value shown for FDTSD calculations without spectral clipping, which is much smaller than the error value that is typically required for transient pressure simulations, is achieved by increasing the computation time by more than an order of magnitude relative to calculations with standard time-space decomposition. To compensate, FDTSD calculations with spectral clipping sacrifice some accuracy while reducing the computation time. FDTSD calculations with spectral clipping also demonstrate larger limiting values for the error ε<sub><italic>p</italic></sub> in the computed transient nearfield pressure than FDTSD without spectral clipping. In <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>, the limiting values for the error in the computed transient nearfield pressure are approximately ε<sub><italic>p</italic></sub> = 4.7·10<sup>−3</sup> and ε<sub><italic>p</italic></sub> = 7.6·10<sup>−4</sup> for errors in the transducer surface velocity given by ε<sub><italic>v</italic></sub> = 4.9·10<sup>−3</sup> and ε<sub><italic>v</italic></sub> = 8.1·10<sup>−4</sup>, respectively. This result suggests that the error in the transducer surface velocity ε<sub><italic>v</italic></sub> is closely related to the limiting value of the error in the computed transient nearfield pressure ε<sub><italic>p</italic></sub>. Furthermore, larger values of ε<sub><italic>v</italic></sub> correspond to shorter computation times for calculations with the same number of abscissas.</p>
<p><xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> also shows the convergence of the error in the transient nearfield pressure ε<sub><italic>p</italic></sub> as a function of computation time for the impulse response and Field II. For transient pressures calculated in the <italic>z</italic> = 3 mm plane, the impulse response converges more slowly than standard time-space decomposition and time-space decomposition without spectral clipping, as indicated by the slope of the impulse response curve in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref>. The smallest error indicated in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> for the error ε<sub><italic>p</italic></sub> produced by Field II is 3.3·10<sup>−3</sup> for λ/15 × λ/15 subelements and 6.9·10<sup>−4</sup> for λ/54 × λ/54 subelements. This suggests that Field II approaches a limiting error value that is defined by the size of the rectangular subelements and by the distance from the computational grid to the transducer. For each of these results, once the limiting value for the error ε<sub><italic>p</italic></sub> is reached, increasing the number of abscissas or the sampling frequency increases the computation time without further reducing the numerical error.</p>
<p><xref ref-type="table" rid="table1-0161734612463847">Table 1</xref> shows the computation times for FDTSD with spectral clipping, time-space decomposition, the impulse response method, and Field II for specified values of the error ε<sub><italic>p</italic></sub> in the simulated transient pressure. The simulation results shown in <xref ref-type="table" rid="table1-0161734612463847">Table 1</xref> are generated by a circular transducer with radius <italic>a</italic> = 1 mm that is excited by a surface velocity described by a four-cycle Hanning-weighted pulse with a center frequency of <italic>f</italic><sub>0</sub> = 5 MHz. The pressure, which is calculated at 368 time samples, is evaluated in a coarse 21 × 21 grid located in the <italic>z</italic> = 3 mm plane. The computation times are given in seconds, and the ratio between the computation time and the time required to calculate the corresponding FDTSD result with spectral clipping is provided underneath each time entry. To calculate the transient pressure for the largest error ε<sub><italic>p</italic></sub> less than or equal to 10<sup>−2</sup>, FDTSD with spectral clipping evaluated with 20 abscissas requires 0.06024 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 6.5·10<sup>−3</sup>, the impulse response evaluated at <italic>f</italic><sub>s</sub> = 2 GHz requires 0.94 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 7.1·10<sup>−3</sup>, and Field II with λ/15 × λ/15 subelements evaluated at <italic>f</italic><sub>s</sub> = 700 MHz requires 1.086 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 8.2·10<sup>−3</sup>. Thus, for calculations that achieve the largest error less than 1% in the simulated transient pressure in the <italic>z</italic> = 3 mm plane, FDTSD with spectral clipping is 16× faster than the impulse response method and 18× faster than Field II. For transient pressure simulations with the largest errors that satisfy ε<sub><italic>p</italic></sub> ≤ 10<sup>−3</sup>, FDTSD with spectral clipping evaluated with 25 abscissas requires 0.1252 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 8.2·10<sup>−4</sup>, the impulse response evaluated at <italic>f</italic><sub>s</sub> = 20 GHz requires 19.22 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 8.2·10<sup>−4</sup>, and Field II with λ/54 × λ/54 subelements evaluated at <italic>f</italic><sub>s</sub> = 20 GHz requires 39.44 seconds to achieve an error of ε<sub><italic>p</italic></sub> = 7.9·10<sup>−4</sup>. Thus, for transient calculations that achieve the largest error less than 0.1%, FDTSD is 154× faster than the impulse response method and 315× faster than Field II. Standard time-space decomposition, which is faster than all of these methods when the transducer surface velocity is described by a Hanning-weighted pulse, requires 0.02153 seconds when calculated with 20 Gauss abscissas and is therefore 2.8× faster than FDTSD with spectral clipping for a 1% error in the computed transient pressure. For a 0.1% error in the computed transient pressure, standard time-space decomposition evaluated with 25 Gauss abscissas requires 0.02549 seconds and is 4.9× faster than FDTSD with spectral clipping.</p>
<table-wrap id="table1-0161734612463847" position="float">
<label>Table 1.</label>
<caption>
<p>Computation Times Required to Achieve the Largest Errors Less than 1% and 0.1% for Transient Pressure Calculations Evaluated in the <italic>z</italic> = 3 mm Plane When the Transducer Surface Velocity Is Described by a Four-Cycle Hanning-Weighted Sinusoidal Pulse</p>
</caption>
<graphic alternate-form-of="table1-0161734612463847" xlink:href="10.1177_0161734612463847-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th/>
<th align="center">FDTSD with Spectral Clipping</th>
<th align="center">TSD</th>
<th align="center">Impulse Response</th>
<th align="center">Field II</th>
</tr>
</thead>
<tbody>
<tr>
<td>ε<sub><italic>p</italic></sub> ≤ 10<sup>−2</sup></td>
<td>0.06024 s</td>
<td>0.02153 s</td>
<td>0.94 s</td>
<td>1.086 s</td>
</tr>
<tr>
<td/>
<td align="center">—</td>
<td><inline-formula id="inline-formula20-0161734612463847">
<mml:math display="inline" id="math37-0161734612463847">
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mo>×</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula></td>
<td>(16×)</td>
<td>(18×)</td>
</tr>
<tr>
<td>ε<sub><italic>p</italic></sub> ≤ 10<sup>−3</sup></td>
<td>0.1252 s</td>
<td>0.02549 s</td>
<td>19.22 s</td>
<td>39.44 s</td>
</tr>
<tr>
<td/>
<td align="center">—</td>
<td>
<inline-formula id="inline-formula21-0161734612463847">
<mml:math display="inline" id="math38-0161734612463847">
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>4</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>9</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mo>×</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
<td>(154×)</td>
<td>(315×)</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1-0161734612463847">
<p>The FDTSD method is significantly faster than the impulse response method and Field II, and the TSD method is fastest overall. The ratio between the computation time relative for each method and the computation time for FDTSD with spectral clipping is given in parenthesis below the corresponding time entry. FDTSD = frequency-domain time-space decomposition; TSD = time-space decomposition</p></fn>
</table-wrap-foot></table-wrap>
</sec>
</sec>
<sec id="section24-0161734612463847">
<title>Gaussian-Modulated Sinusoidal Pulse</title>
<p>The FDTSD method is primarily intended for transducer surface velocity signals that are inconsistent with the analytical representation in (7), which is the expression required for standard time-space decomposition. One such signal is the Gaussian-modulated sinusoidal pulse in (17), which contains a square term in the exponential function that prevents analytical factorization into a sum of products of temporal and spatial terms. Although the standard time-space decomposition approach is excluded from transient calculations with any signal that contains a Gaussian component, this signal is readily applicable to the FDTSD method with and without spectral clipping, the impulse response approach, and Field II.</p>
<p><xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref> shows the errors in the transient nearfield pressure calculated by these three methods as a function of the computation time for a transducer surface velocity signal <italic>v</italic>(<italic>t</italic>) described by a four-cycle Gaussian-modulated sinusoidal pulse. The center frequency defined for these calculations is 5 MHz, the values of the offset and standard deviation defined for (17) are <italic>t</italic><sub>0</sub> = 0.4 µs and σ = 0.133 µs, respectively, and the sampling frequency is 100 MHz. The transient nearfield pressure is computed at 515 time points in the <italic>z</italic> = 150 µm plane on a 21 × 21 point spatial grid with 200 µm spacing. The FDTSD results with spectral clipping shown in <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref> are again calculated for the largest errors ε<sub><italic>v</italic></sub> in the transducer surface velocity signals below 1% and 0.1%. For FDTSD simulations, the number of abscissas is varied from 5 to 80 in increments of 5. For Field II and impulse response calculations, the temporal sampling rate is varied from 100 MHz to 50 GHz. The square subelements defined for Field II calculations are λ/24 × λ/24 and λ/90 × λ/90 at the center frequency for calculations with asymptotic trends in the errors that are consistently below 1% and 0.1%, respectively, as the sampling frequency increases.</p>
<fig id="fig6-0161734612463847" position="float">
<label>Figure 6.</label>
<caption>
<p>Numerical error ε<sub><italic>p</italic></sub> in the transient pressure field evaluated in the <italic>z</italic> = 150 µm plane plotted as a function of the computation time for several different simulation methods, where the transducer surface velocity applied to each simulation is described by a four-cycle Gaussian-modulated sinusoidal pulse. Each result shown describes the reduction in the error ε<sub><italic>p</italic></sub> and the corresponding increase in the computation time as the number of abscissas increases from 5 to 80 (frequency-domain time-space decomposition with and without spectral clipping) or as the temporal sampling rate increases from 100 MHz to 50 GHz (the impulse response and Field II).</p>
</caption>
<graphic xlink:href="10.1177_0161734612463847-fig6.tif"/></fig>
<p>Several of the trends observed when the transducer surface velocity <italic>v</italic>(<italic>t</italic>) is described by a Hanning-weighted sinusoidal pulse in <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> are also identified in <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref> when <italic>v</italic>(<italic>t</italic>) is given by a Gaussian-weighted sinusoidal pulse. When ranked from fastest to slowest for the largest errors in the simulated transient pressure below 1%, the ordering is (a) FDTSD with spectral clipping and an error in <inline-formula id="inline-formula22-0161734612463847">
<mml:math display="inline" id="math39-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> given by ε<sub><italic>v</italic></sub> = 6.0·10<sup>−3</sup> (solid line with circle markers), (b) FDTSD with spectral clipping and an error in <italic>v</italic>(<italic>t</italic>) given by ε<sub><italic>v</italic></sub> = 8.8·10<sup>−4</sup> (dashed line with square markers), (c) FDTSD without spectral clipping (dash-dot line with diamond markers), (d) the impulse response method (dotted line with + markers), (e) Field II with λ/24 × λ/24 subelements (solid line with × markers), and (f) Field II with λ/90 × λ/90 subelements (dashed line with * markers). In <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref>, the FDTSD results with spectral clipping rapidly converge at first before reaching a limiting value, where the limiting value for the error ε<sub><italic>p</italic></sub> in the computed transient pressure approximately tracks the specified error in <inline-formula id="inline-formula23-0161734612463847">
<mml:math display="inline" id="math40-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> for both values of ε<sub><italic>v</italic></sub>. The FDTSD result with ε<sub><italic>v</italic></sub> = 6.0·10<sup>−3</sup>, which is calculated with six complex terms, reaches the limiting value of ε<sub><italic>p</italic></sub> = 6.9·10<sup>−3</sup> in the computed transient field in 0.1199 seconds. Likewise, the FDTSD result with ε<sub><italic>v</italic></sub> = 8.8·10<sup>−4</sup>, which is calculated with 10 complex terms, reaches the limiting value of ε<sub><italic>p</italic></sub> = 7.4·10<sup>−4</sup> in 0.2168 seconds. This result demonstrates that faster simulations are achieved when a larger error in the transducer surface velocity is permitted. As shown in <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref>, FDTSD simulations with spectral clipping also reduce the computation time by a significant amount relative to the other calculation methods.</p>
<p><xref ref-type="table" rid="table2-0161734612463847">Table 2</xref> shows the computation times required to achieve the largest errors smaller than 1% and 0.1% for transient pressure calculations evaluated in the <italic>z</italic> = 150 µm plane when the transducer surface velocity <italic>v</italic>(<italic>t</italic>) is represented by the four-cycle Gaussian-modulated sinusoidal pulse in (17). In <xref ref-type="table" rid="table2-0161734612463847">Table 2</xref>, these times are evaluated for FDTSD with spectral clipping, the impulse response method, and Field II. For the transient pressure calculation in the <italic>z</italic> = 150 µm plane with the largest error ε<sub><italic>p</italic></sub> less than or equal to 10<sup>−2</sup>, FDTSD with spectral clipping evaluated with 25 Gauss abscissas achieves an error of ε<sub><italic>p</italic></sub> = 9.8·10<sup>−3</sup> in 0.104 seconds, the impulse response evaluated with <italic>f</italic><sub>s</sub> = 2 GHz achieves an error of ε<sub><italic>p</italic></sub> = 7.2·10<sup>−3</sup> in 1.684 seconds, and Field II evaluated with <italic>f</italic><sub>s</sub> = 400 MHz and λ/24 × λ/24 subelements achieves an error of ε<sub><italic>p</italic></sub> = 8.6·10<sup>−3</sup> in 3.099 seconds. Thus, for calculations with a four-cycle Gaussian-modulated sinusoidal pulse that achieve an error less than 1% in the simulated transient pressure in the <italic>z</italic> = 150 µm plane, FDTSD with spectral clipping is 16× faster than the impulse response method and 30× faster than Field II. For transient pressure simulations with the largest errors that satisfy ε<sub><italic>p</italic></sub> ≤ 10<sup>−3</sup>, FDTSD with spectral clipping evaluated with 30 abscissas achieves an error of ε<sub><italic>p</italic></sub> = 8.9·10<sup>−4</sup> in 0.1927 seconds, the impulse response evaluated with <italic>f</italic><sub>s</sub> = 20 GHz achieves an error of ε<sub><italic>p</italic></sub> = 6.9·10<sup>−4</sup> in 20.88 seconds, and Field II evaluated with <italic>f</italic><sub>s</sub> = 6 GHz and λ/90 × λ/90 subelements achieves an error of ε<sub><italic>p</italic></sub> = 8.8·10<sup>−4</sup> in 55.3 seconds. For calculations with the Gaussian-modulated sinusoidal pulse that achieve an error less than 0.1% in the simulated transient pressure in the <italic>z</italic> = 150 µm plane, FDTSD with spectral clipping is therefore 108× faster than the impulse response method and 287× faster than Field II.</p>
<table-wrap id="table2-0161734612463847" position="float">
<label>Table 2.</label>
<caption>
<p>Computation Times Required to Achieve Errors of 1% and 0.1% for Transient Pressure Calculations Evaluated in the <italic>z</italic> = 150 µm Plane When the Transducer Surface Velocity Is Described by a Four-Cycle Gaussian-Modulated Sinusoidal Pulse</p>
</caption>
<graphic alternate-form-of="table2-0161734612463847" xlink:href="10.1177_0161734612463847-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th/>
<th align="center">FDTSD with Spectral Clipping</th>
<th align="center">Impulse Response</th>
<th align="center">Field II</th>
</tr>
</thead>
<tbody>
<tr>
<td>ε<sub><italic>p</italic></sub> ≤ 10<sup>−2</sup></td>
<td>0.104 s</td>
<td>1.684 s</td>
<td>3.099 s</td>
</tr>
<tr>
<td/>
<td align="center">—</td>
<td>(16×)</td>
<td>(30×)</td>
</tr>
<tr>
<td>ε<sub><italic>p</italic></sub> ≤ 10<sup>−3</sup></td>
<td>0.1927 s</td>
<td>20.88 s</td>
<td>55.3 s</td>
</tr>
<tr>
<td/>
<td align="center">—</td>
<td>(108×)</td>
<td>(287×)</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn2-0161734612463847"><p>The FDTSD method is again significantly faster than the impulse response method and Field II. The ratio between the computation time relative for each method and the computation time for FDTSD with spectral clipping is given in parenthesis below the corresponding time entry. FDTSD = frequency-domain time-space decomposition.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="section25-0161734612463847">
<title>Computer Memory Utilization</title>
<p>For transient nearfield pressure simulations, the amount of computer memory typically limits the maximum size of the computational grid and the accuracy of the result. In comparisons of the computer memory used by these simulation methods, the transducer surface velocity is represented by the four-cycle Gaussian-modulated sinusoidal pulse, and the pressure is evaluated on a 21 × 21 grid with 200 µm spacing located in the <italic>z</italic> = 150 µm plane. By calculating the pressure at a relatively short distance from the transducer, this comparison describes a worst-case scenario for memory usage due to the relatively long time duration of the impulse response and of the transient pressure signal. All of the calculations retain the same parameters evaluated previously for calculations with the four-cycle Gaussian-modulated sinusoidal pulse in the <italic>z</italic> = 150 µm plane. For simulations in this plane, the FDTSD method requires 3.2 MB of memory for calculations with 80 abscissas. Since FDTSD calculations accumulate the results for each complex-valued term “in place” using the same memory locations, the amount of memory required for FDTSD calculations is independent of the transducer surface velocity <italic>v</italic>(<italic>t</italic>) and the spectral clipping threshold. The impulse response reference solution requires 228 MB of memory, which is 71× more than the FDTSD method requires. For Field II calculations with λ/90 × λ/90 subelements, a temporal sampling frequency of 100 MHz yields an error in the simulated transient pressure of about ε<sub><italic>p</italic></sub> = 5.1·10<sup>−2</sup>, and 81 MB of computer memory is required for this calculation, which is 25× more than FDTSD needs for the same calculation. Increasing the sampling frequency for Field II calculations with λ/90 × λ/90 subelements to 50 GHz, which yields an error of ε<sub><italic>p</italic></sub> = 8.2·10<sup>−4</sup>, increases the amount of computer memory required to 902 MB, or 282× more than that needed for the same calculation with the FDTSD method.</p>
</sec>
</sec>
<sec id="section26-0161734612463847" sec-type="discussion">
<title>Discussion</title>
<sec id="section27-0161734612463847">
<title>Reference Pressure Field Calculations</title>
<p>The reference pressure field for <xref ref-type="fig" rid="fig5-0161734612463847">Figure 5</xref> was computed with the impulse response in 269 seconds, and the reference for <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref> was computed with the impulse response in 638 seconds. In contrast, the FDTSD calculation without spectral clipping, when applied to the fast nearfield method expression in (5), achieves approximately the same accuracy in 1.212 seconds and 1.685 seconds for the same two respective calculations. Thus, if used as a reference for these calculations, the FDTSD without spectral clipping is 222× faster and 379× faster than the impulse response for transient pressure calculations with these two input waveforms evaluated in these two locations. This result suggests that the FDTSD approach provides a better reference for transient pressure calculations in the nearfield region. However, the FDTSD method is a new approach with a previously uncharacterized error performance, so the impulse response was selected as the reference.</p>
</sec>
<sec id="section28-0161734612463847">
<title>Spectral Clipping</title>
<p>The primary objective of spectral clipping is to reduce the computation time while maintaining the numerical error in the simulated transient pressure below a specified level. This is achieved by retaining only the complex-valued terms with a substantial contribution to the computed transient field and by discarding the complex-valued terms with a relatively insignificant contribution. In effect, spectral clipping applies lossy compression to the input signal that represents the transducer surface velocity <italic>v</italic>(<italic>t</italic>). The compressed signal <inline-formula id="inline-formula24-0161734612463847">
<mml:math display="inline" id="math41-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is efficiently evaluated by FDTSD combined with the fast nearfield method when the threshold for discarding complex-valued terms is selected appropriately. Other forms of compression are also applicable to FDTSD calculations, including the discrete cosine transform, the matrix pencil method, and the wavelet transform. The main benefits of the FFT-based approach evaluated here are derived from the wide availability of FFT routines and the straightforward interface to these routines provided by MATLAB. These familiar routines enable the compression of <italic>v</italic>(<italic>t</italic>) with a minimum amount of programming effort. The other approaches are expected to achieve similar reductions in the computation time while maintaining a specified error in the computed transient pressure; however, these require different derivations for the <italic>f<sub>n</sub></italic>(τ) and <italic>g<sub>n</sub></italic>(<italic>t</italic>) terms. To achieve similar performance, the <italic>f<sub>n</sub></italic>(τ) terms in particular should avoid transcendental functions with lengthy computation times.</p>
<p>Spectral clipping is expected to demonstrate an even greater reduction in the computation time for transducer surface velocity signals with narrow bandwidths. When fewer complex-valued terms are required for the approximate signal representation, the number of terms required for FDTSD calculations is also reduced. Likewise, as the number of complex-valued terms required to represent a wideband signal increases, there is a corresponding increase in the computation time. For FDTSD calculations with spectral clipping, the computation time is proportional to the number of complex-valued terms. This linear relationship is consistently observed for every signal representation evaluated.</p>
<p>The results shown in <xref ref-type="fig" rid="fig5-0161734612463847">Figures 5</xref> and <xref ref-type="fig" rid="fig6-0161734612463847">6</xref> suggest that, when the fast nearfield method expression in (5) is calculated with a sufficient number of abscissas, the error ε<sub><italic>p</italic></sub> in the transient pressure field calculated with FDTSD and spectral clipping is primarily determined by the error ε<sub><italic>v</italic></sub> in the compressed signal representation <inline-formula id="inline-formula25-0161734612463847">
<mml:math display="inline" id="math42-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>. Consequently, the value selected for ε<sub><italic>v</italic></sub> provides an a priori estimate for the error ε<sub><italic>p</italic></sub> of the simulated transient pressure field. The close connection between ε<sub><italic>p</italic></sub> and ε<sub><italic>v</italic></sub> is explained by treating the combination of the FDTSD approach and the fast nearfield method as a linear transfer function. In these calculations, an approximately proportional relationship between ε<sub><italic>p</italic></sub> and ε<sub><italic>v</italic></sub> is maintained if the error in the compressed signal <inline-formula id="inline-formula26-0161734612463847">
<mml:math display="inline" id="math43-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is the dominant source of error in the simulated transient pressure.</p>
</sec>
<sec id="section29-0161734612463847">
<title>Transducer Geometries and Transient Diffraction Models</title>
<p>FDTSD is applicable to any transducer geometry with a fast nearfield method expression, including rectangular<sup><xref ref-type="bibr" rid="bibr15-0161734612463847">15</xref></sup> and triangular<sup><xref ref-type="bibr" rid="bibr39-0161734612463847">39</xref></sup> transducers with spatially uniform normal surface velocities, apodized circular transducers,<sup><xref ref-type="bibr" rid="bibr42-0161734612463847">42</xref></sup> and apodized rectangular transducers.<sup><xref ref-type="bibr" rid="bibr32-0161734612463847">32</xref></sup> The approach for simulating these other transducer geometries is essentially the same as that for a circular transducer with spatially uniform normal surface velocity. The only significant differences are that the fast nearfield method expression is uniquely specified for each transducer geometry and that apodized and unapodized transducers with the same shape are modeled by different fast nearfield method expressions.</p>
</sec>
<sec id="section30-0161734612463847">
<title>Memory Utilization</title>
<p>For any transient calculation, the amount of available computer memory is an important limitation that determines the number of time samples, the size of the computational grid, and for some methods, the accuracy of the solution. Any simulation based on the impulse response risks running out of memory, especially when temporal sampling is increased to reduce nearfield errors. Simulations that calculate transient pressures with the fast nearfield method combined with either standard time-space decomposition or FDTSD can also run out of memory; however, these methods have some unique advantages over calculations that evaluate the impulse response. First, all fast nearfield method calculations with either of the time-space decomposition approaches are performed “in place,” so very little additional overhead is required for these calculations. Thus, the total amount of memory required to perform a transient simulation is approximately the same as that required to store the final result, and this quantity is readily determined before any calculations take place. Second, transient calculations with the fast nearfield method require much smaller temporal sampling rates than the impulse response or Field II. Consequently, the memory required to calculate and store a result is much smaller for transient pressure calculations performed with the fast nearfield method combined with either standard time-space decomposition or FDTSD. Finally, the memory requirements for FDTSD calculations are independent of the pulse shape. Results not shown here demonstrate that, when evaluated in the same plane, the memory usage for calculations with the Gaussian-modulated sinusoidal pulse is the same as that for simulations with the Hanning-weighted sinusoidal pulse. Thus, the only factors that influence the amount of memory required for FDTSD simulations are the signal duration and the temporal sampling rate, which is selected so that aliasing is avoided in the calculated transient pressure.</p>
</sec>
<sec id="section31-0161734612463847">
<title>Other Signal Waveforms and Applications</title>
<p>The FDTSD approach facilitates simulations of transient pressures produced by other transducer surface velocity signals. For example, a linear chirp signal was also evaluated, and the trends in the simulations (not shown) were comparable with those shown in <xref ref-type="fig" rid="fig6-0161734612463847">Figure 6</xref>. In addition, the FDTSD approach enables fast nearfield method calculations that utilize transducer surface velocity signals obtained from electro-mechanical transducer simulations or from measured values. The FDTSD approach also facilitates simulations of time reversal and ultrasound imaging. For simulations of ultrasound imaging,<sup><xref ref-type="bibr" rid="bibr43-0161734612463847">43</xref><xref ref-type="bibr" rid="bibr44-0161734612463847"/>-<xref ref-type="bibr" rid="bibr45-0161734612463847">45</xref></sup> the FDTSD approach combined with the fast nearfield method will calculate the transmit and receive beam patterns, and then these will be convolved to obtain the postbeamformed result.</p>
<p>The FDTSD approach is also readily extended to any time-limited real-valued signal represented by a Fourier series. The Fourier series, as applied to FDTSD, also admits solutions in terms of sines/cosines or complex exponential functions with real or complex-valued coefficients, respectively. This provides an alternative FDTSD approach for various analytical <italic>v</italic>(<italic>t</italic>) with Fourier series representations. Whereas the FFT or DFT of <italic>v</italic>(<italic>t</italic>) always contains a finite number of terms, the Fourier series representation of <italic>v</italic>(<italic>t</italic>) typically contains an infinite number of terms. These terms are also amenable to spectral clipping. For example, spectral clipping, when applied to the Fourier series for one or more cycles of a square wave or sawtooth signal, will enable FDTSD calculations of the nearfield transient pressure for these signal representations.</p>
</sec>
<sec id="section32-0161734612463847">
<title>Other Frequency-Domain Methods</title>
<p>FDTSD is distinct from other methods that multiply the Fourier components of the input signal with the frequency-domain diffraction transfer function. These methods separately calculate each frequency component of the diffracted field, and then the frequency-domain diffraction transfer function is populated with these values. The number of frequency components calculated is determined by the duration of the entire computed transient pressure signal, which is equal to the sum of the time durations of the transducer surface velocity signal and the impulse response of the velocity potential evaluated at a particular point in space. The minimum number of frequency components is then equal to the number of time samples required to represent the duration of the entire computed transient pressure signal, otherwise a circular convolution artifact is observed in the result. To obtain the transient pressure, the input signal is zero-padded so that the time duration is equal to that of the computed pressure signal, the diffraction transfer function is calculated at each corresponding frequency, and the spectra are multiplied. The inverse FFT is then evaluated at each point in space.</p>
<p>In contrast, the FDTSD approach evaluates the contribution from each complex term in the time domain. After calculating the FFT of the input signal, FDTSD calculations of the transient pressure evaluate the temporal terms analytically, and the spatial terms are calculated numerically. The FDTSD approach thereby enables direct calculations of uniformly sampled transient pressure waveforms, nonuniformly sampled transient pressure waveforms, single time points, or any portion of the transient pressure waveform, whereas other frequency-domain methods typically require uniform sampling of the entire computed transient pressure signal.</p>
</sec>
<sec id="section33-0161734612463847">
<title>FDTSD in FOCUS</title>
<p>FOCUS previously only supported transient pressure calculations with the fast nearfield method combined with standard time-space decomposition for unapodized circular, rectangular, and spherically focused transducers. A new routine based on the FDTSD approach is now available in FOCUS for unapodized circular transducers, and corresponding FDTSD routines for other transducer shapes are presently under development. This routine processes an entire sampled waveform along with an optional threshold parameter for spectral clipping. By facilitating transient pressure simulations for any discretized signal <italic>v</italic>(<italic>t</italic>), these new FDTSD routines will thereby address an important limitation of FOCUS.</p>
</sec>
</sec>
<sec id="section34-0161734612463847" sec-type="conclusions">
<title>Conclusion</title>
<p>FDTSD combined with the fast nearfield method rapidly and accurately simulates transient pressure fields generated by circular transducers. The FDTSD approach converts a temporally sampled transducer surface velocity signal into an equivalent complex-valued signal representation that is subsequently evaluated for transient pressure calculations. FDTSD, which is applicable to any discretized signal, extends the capabilities of time-space decomposition, which is limited to certain specific analytical signal representations. The performance of FDTSD is further improved by spectral clipping, which retains only the essential complex-valued terms for transient pressure calculations. Simulation results show that the FDTSD approach combined with the fast nearfield method and spectral clipping consistently calculates nearfield transient pressures in less time with smaller numerical errors and with less computer memory than Field II and the impulse response method. For simulations of transient pressures generated by a circular transducer excited by two different analytical representations of the normal surface velocity, FDTSD combined with the fast nearfield method and spectral clipping is one or two orders of magnitude faster and also requires less computer memory than both the impulse response method and Field II for calculations that achieve comparable errors ε<sub><italic>p</italic></sub> in the computed pressure. Results also suggest that the threshold defined for FDTSD with spectral clipping is closely related to the error in the computed transient pressure and that this value provides an a priori estimate of the error in the computed transient pressure field provided that the error in the compressed signal <inline-formula id="inline-formula27-0161734612463847">
<mml:math display="inline" id="math44-0161734612463847">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> is the dominant source of error in the simulated transient pressure.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="conflict">
<label>Declaration of Conflicting Interests</label>
<p>The author(s) declared no potential conflicts of interest with respect to the research, authorship, and/or publication of this article.</p>
</fn>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>The author(s) disclosed receipt of the following financial support for the research, authorship, and/or publication of this article: This work was supported in part by the National Institutes of Health Grant R01 EB012079.</p></fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0161734612463847">
<label>1.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Pierce</surname><given-names>AD</given-names></name>
</person-group>. <source>Acoustics: An Introduction to its physical principles</source>. <edition>2nd ed.</edition> <publisher-loc>Woodbury, NY</publisher-loc>: <publisher-name>Acoustical Society of America</publisher-name>, <year>1989</year>, pp. <fpage>213</fpage>-<lpage>215</lpage>.</citation>
</ref>
<ref id="bibr2-0161734612463847">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Crombie</surname><given-names>P</given-names></name>
<name><surname>Bascom</surname><given-names>PAJ</given-names></name>
<name><surname>Cobbold</surname><given-names>RSC</given-names></name>
</person-group>. <article-title>Calculating the pulsed response of linear arrays: accuracy versus computational efficiency</article-title>. <source>IEEE Trans Ultrason Ferroelect Freq Contr</source>. <year>1997</year>;<volume>44</volume>(<issue>5</issue>):<fpage>997</fpage>-<lpage>1009</lpage>.</citation>
</ref>
<ref id="bibr3-0161734612463847">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Oberhettinger</surname><given-names>F</given-names></name>
</person-group>. <article-title>On transient solutions of the “baffled piston” problem</article-title>. <source>J Res Nat Bur Stand, Sect. B. Mathematics and Mathematical Physics</source>. <year>1961</year>;<volume>65B</volume>(<issue>1</issue>):<fpage>1</fpage>-<lpage>6</lpage>.</citation>
</ref>
<ref id="bibr4-0161734612463847">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lockwood</surname><given-names>JC</given-names></name>
<name><surname>Willette</surname><given-names>JG</given-names></name>
</person-group>. <article-title>High-speed method for computing the exact solution for the pressure variations in the nearfield of a baffled piston</article-title>. <source>J Acoust Soc Am</source>. <year>1973</year>;<volume>53</volume>(<issue>3</issue>):<fpage>735</fpage>-<lpage>41</lpage>.</citation>
</ref>
<ref id="bibr5-0161734612463847">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Ullate</surname><given-names>LG</given-names></name>
<name><surname>San Emeterio</surname><given-names>JL</given-names></name>
</person-group>. <article-title>A new algorithm to calculate the transient near-field of ultrasonic phased-arrays</article-title>. <source>IEEE Trans Ultrason Ferroelect Freq Contr</source>. <year>1992</year>;<volume>39</volume>(<issue>6</issue>):<fpage>745</fpage>-<lpage>53</lpage>.</citation>
</ref>
<ref id="bibr6-0161734612463847">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JA</given-names></name>
</person-group>. <article-title>Ultrasound fields from triangular apertures</article-title>. <source>J Acoust Soc Am</source>. <year>1996</year>;<volume>100</volume>(<issue>4</issue>):<fpage>2049</fpage>-<lpage>56</lpage>.</citation>
</ref>
<ref id="bibr7-0161734612463847">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Penttinen</surname><given-names>A</given-names></name>
<name><surname>Luukkala</surname><given-names>M</given-names></name>
</person-group>. <article-title>The impulse response and pressure nearfield of a curved ultrasonic radiator</article-title>. <source>J Phys D: Appl Phys</source>. <year>1976</year>;<volume>9</volume>(<issue>10</issue>):<fpage>1547</fpage>-<lpage>57</lpage>.</citation>
</ref>
<ref id="bibr8-0161734612463847">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Arditi</surname><given-names>M</given-names></name>
<name><surname>Foster</surname><given-names>FS</given-names></name>
<name><surname>Hunt</surname><given-names>JW</given-names></name>
</person-group>. <article-title>Transient fields of concave annular arrays</article-title>. <source>Ultrason Imag</source>. <year>1981</year>;<volume>3</volume>(<issue>1</issue>):<fpage>37</fpage>-<lpage>61</lpage>.</citation>
</ref>
<ref id="bibr9-0161734612463847">
<label>9.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Faure</surname><given-names>P</given-names></name>
<name><surname>Cathignol</surname><given-names>D</given-names></name>
<name><surname>Chapelon</surname><given-names>JY</given-names></name>
<name><surname>Newhouse</surname><given-names>VL</given-names></name>
</person-group>. <article-title>On the pressure field of a transducer in the form of a curved strip</article-title>. <source>J Acoust Soc Am</source>. <year>1994</year>;<volume>95</volume>(<issue>2</issue>):<fpage>628</fpage>-<lpage>37</lpage>.</citation>
</ref>
<ref id="bibr10-0161734612463847">
<label>10.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Ketterling</surname><given-names>JA</given-names></name>
</person-group>. <article-title>Acoustic field of a wedge-shaped section of a spherical cap transducer</article-title>. <source>J Acoust Soc Am</source>. <year>2003</year>; <volume>114</volume>(<issue>6</issue>): <fpage>3065</fpage>-<lpage>75</lpage>.</citation>
</ref>
<ref id="bibr11-0161734612463847">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Stepanishen</surname><given-names>PR</given-names></name>
</person-group>. <article-title>Transient radiation from pistons in an infinite planar baffle</article-title>. <source>J Acoust Soc Am</source> <year>1971</year>;<volume>49</volume>(<issue>5</issue>):<fpage>1629</fpage>-<lpage>38</lpage>.</citation>
</ref>
<ref id="bibr12-0161734612463847">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>D’hooge</surname><given-names>J</given-names></name>
<name><surname>Nuyts</surname><given-names>J</given-names></name>
<name><surname>Bijnens</surname><given-names>B</given-names></name>
<name><surname>De Man</surname><given-names>B</given-names></name>
<name><surname>Suetens</surname><given-names>P</given-names></name>
<name><surname>Thoen</surname><given-names>J</given-names></name><etal/>
</person-group>. <article-title>The calculation of the transient near and far field of a baffed piston using low sampling frequencies</article-title>. <source>J Acoust Soc Am</source>. <year>1997</year>;<volume>102</volume>(<issue>1</issue>):<fpage>78</fpage>-<lpage>86</lpage>.</citation>
</ref>
<ref id="bibr13-0161734612463847">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JA</given-names></name>
</person-group>. <article-title>Speed-accuracy trade-offs in computing spatial impulse responses for simulating medical ultrasound imaging</article-title>. <source>J Comput Acoust</source>. <year>2001</year>;<volume>9</volume>(<issue>3</issue>):<fpage>731</fpage>-<lpage>44</lpage>.</citation>
</ref>
<ref id="bibr14-0161734612463847">
<label>14.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>McGough</surname><given-names>RJ</given-names></name>
<name><surname>Samulski</surname><given-names>TV</given-names></name>
<name><surname>Kelly</surname><given-names>JF</given-names></name>
</person-group>. <article-title>An efficient grid sectoring method for calculations of the nearfield pressure generated by a circular piston</article-title>. <source>J Acoust Soc Am</source>. <year>2004</year>;<volume>115</volume>(<issue>5</issue>):<fpage>1942</fpage>-<lpage>54</lpage>.</citation>
</ref>
<ref id="bibr15-0161734612463847">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>Rapid calculations of time-harmonic nearfield pressures produced by rectangular pistons</article-title>. <source>J Acoust Soc Am</source>. <year>2004</year>;<volume>115</volume>(<issue>5</issue>):<fpage>1934</fpage>-<lpage>41</lpage>.</citation>
</ref>
<ref id="bibr16-0161734612463847">
<label>16.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kelly</surname><given-names>JF</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>A time-space decomposition method for calculating the nearfield pressure generated by a pulsed circular piston</article-title>. <source>IEEE Trans Ultrason Ferroelect Freq Contr</source>. <year>2006</year>;<volume>53</volume>(<issue>6</issue>):<fpage>1150</fpage>-<lpage>9</lpage>.</citation>
</ref>
<ref id="bibr17-0161734612463847">
<label>17.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Holm</surname><given-names>S</given-names></name>
</person-group>. <source>Simulation of acoustic fields from medical ultrasound transducers of arbitrary shape</source>. <conf-name>In Proceedings of Nordic Symposium on Physical Acoustics</conf-name>. <conf-loc>Ustaoset, Norway</conf-loc>, <year>1995</year>, pp. <fpage>54</fpage>-<lpage>7</lpage>.</citation>
</ref>
<ref id="bibr18-0161734612463847">
<label>18.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Epasinghe</surname><given-names>K</given-names></name>
<name><surname>Holm</surname><given-names>S</given-names></name>
</person-group>. <source>Simulation of 3d acoustic fields on a concurrent computer</source>. <conf-name>In Proceedings of Nordic Symposium on Physical Acoustics</conf-name>. <conf-loc>Ustaoset, Norway</conf-loc>, <year>1996</year>, pp. <fpage>4</fpage>-<lpage>5</lpage>.</citation>
</ref>
<ref id="bibr19-0161734612463847">
<label>19.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Holm</surname><given-names>S</given-names></name>
</person-group>. <source>Ultrasim-a toolbox for ultrasound field simulation</source>. <conf-name>In Proceedings of Nordic MATLAB Conference</conf-name>. <conf-loc>Oslo, Norway</conf-loc>, <year>2001</year>, pp. <fpage>1</fpage>-<lpage>4</lpage>.</citation>
</ref>
<ref id="bibr20-0161734612463847">
<label>20.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Aitkenhead</surname><given-names>AH</given-names></name>
<name><surname>Mills</surname><given-names>JA</given-names></name>
<name><surname>Wilson</surname><given-names>AJ</given-names></name>
</person-group>. <article-title>An analysis of the origin of differences between measured and simulated fields produced by a 15-element ultrasound phased array</article-title>. <source>Ultrasound Med Biol</source>. <year>2010</year>;<volume>36</volume>(<issue>3</issue>):<fpage>410</fpage>-<lpage>8</lpage>.</citation>
</ref>
<ref id="bibr21-0161734612463847">
<label>21.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Piwakowski</surname><given-names>B</given-names></name>
<name><surname>Sbai</surname><given-names>K</given-names></name>
</person-group>. <article-title>A new approach to calculate the field radiated from arbitrarily structured transducer arrays</article-title>. <source>IEEE Trans Ultrason Ferroelectrics Freq Contr</source>. <year>1999</year>;<volume>46</volume>(<issue>2</issue>):<fpage>422</fpage>-<lpage>40</lpage>.</citation>
</ref>
<ref id="bibr22-0161734612463847">
<label>22.</label>
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Lingvall</surname><given-names>F</given-names></name>
<name><surname>Piwakowski</surname><given-names>B</given-names></name>
<name><surname>Zang</surname><given-names>G-M</given-names></name>
</person-group>. <article-title>The DREAM toolbox</article-title>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.signal.uu.se/Toolbox/dream/index.shtml">http://www.signal.uu.se/Toolbox/dream/index.shtml</ext-link></citation>
</ref>
<ref id="bibr23-0161734612463847">
<label>23.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Olofsson</surname><given-names>T</given-names></name>
<name><surname>Wennerstrom</surname><given-names>E</given-names></name>
</person-group>. <article-title>Sparse deconvolution of B-scan images</article-title>. <source>IEEE Trans Ultrason Ferroelectrics Freq Contr</source>. <year>2007</year>;<volume>54</volume>(<issue>8</issue>):<fpage>1634</fpage>-<lpage>41</lpage>.</citation>
</ref>
<ref id="bibr24-0161734612463847">
<label>24.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Moraru</surname><given-names>L</given-names></name>
<name><surname>Onose</surname><given-names>L</given-names></name>
</person-group>. <article-title>Analysis of beamforming from various transducer shape</article-title>. <source>J Sci Arts</source>. <year>2010</year>;<volume>2</volume>(<issue>13</issue>):<fpage>349</fpage>-<lpage>54</lpage>.</citation>
</ref>
<ref id="bibr25-0161734612463847">
<label>25.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Guiroy</surname><given-names>A</given-names></name>
<name><surname>Certon</surname><given-names>D</given-names></name>
<name><surname>Boy</surname><given-names>P</given-names></name>
<name><surname>Lethiecq</surname><given-names>M</given-names></name>
<name><surname>Levassort</surname><given-names>F</given-names></name>
</person-group>. <article-title>2D numerical modeling for transducers with combined pseudospectral and finite difference methods: application to high frequency linear arrays</article-title>. <source>Acoustical Imaging</source>. <year>2012</year>;<fpage>351</fpage>-<lpage>61</lpage>.</citation>
</ref>
<ref id="bibr26-0161734612463847">
<label>26.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JA</given-names></name>
</person-group>. <article-title>Field: a program for simulating ultrasound systems. 10th Nordic-Baltic Conference on Biomedical Imaging</article-title>. <source>Med Biol Eng Comp</source>. <year>1996</year>; <volume>4</volume>(<supplement>Suppl. 1</supplement>), Part 1(1)351-3.</citation>
</ref>
<ref id="bibr27-0161734612463847">
<label>27.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Stotzka</surname><given-names>R</given-names></name>
<name><surname>Widmann</surname><given-names>H</given-names></name>
<name><surname>Mueller</surname><given-names>TO</given-names></name>
<name><surname>Schlote-Holubek</surname><given-names>K</given-names></name>
<name><surname>Gemmeke</surname><given-names>H</given-names></name>
<name><surname>Ruiter</surname><given-names>NV</given-names></name><etal/>
</person-group>. <article-title>Prototype of a new 3D ultrasound computer tomography system: transducer design and data recording</article-title>. <source>In Proceedings of SPIE Medical Imaging</source>. <year>2004</year>;<volume>5373</volume>:<fpage>70</fpage>-<lpage>9</lpage>.</citation>
</ref>
<ref id="bibr28-0161734612463847">
<label>28.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cannata</surname><given-names>JM</given-names></name>
<name><surname>Williams</surname><given-names>JA</given-names></name>
<name><surname>Zhou</surname><given-names>Q</given-names></name>
<name><surname>Ritter</surname><given-names>TA</given-names></name>
<name><surname>Shung</surname><given-names>KK</given-names></name>
</person-group>. <article-title>Development of a 35-MHz piezo-composite ultrasound array for medical imaging</article-title>. <source>IEEE Trans Ultrason Ferroelect Freq Contr</source>. <year>2006</year>;<volume>53</volume>(<issue>1</issue>):<fpage>224</fpage>-<lpage>36</lpage>.</citation>
</ref>
<ref id="bibr29-0161734612463847">
<label>29.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Dahl</surname><given-names>JJ</given-names></name>
<name><surname>Pinton</surname><given-names>GF</given-names></name>
<name><surname>Palmeri</surname><given-names>ML</given-names></name>
<name><surname>Agrawal</surname><given-names>V</given-names></name>
<name><surname>Nightingale</surname><given-names>KR</given-names></name>
<name><surname>Trahey</surname><given-names>GE</given-names></name>
</person-group>. <article-title>A parallel tracking method for acoustic radiation force impulse imaging</article-title>. <source>IEEE Trans Ultrason Ferroelectr Freq Control</source>. <year>2007</year>;<volume>54</volume>(<issue>2</issue>):<fpage>301</fpage>-<lpage>12</lpage>.</citation>
</ref>
<ref id="bibr30-0161734612463847">
<label>30.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Zeng</surname><given-names>X</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>Evaluation of the angular spectrum approach for simulations of near-field pressures</article-title>. <source>J Acoust Soc Am</source>. <year>2008</year>;<volume>123</volume>(<issue>1</issue>):<fpage>68</fpage>-<lpage>76</lpage>.</citation>
</ref>
<ref id="bibr31-0161734612463847">
<label>31.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Zeng</surname><given-names>X</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>Optimal simulations of ultrasonic fields produced by large thermal therapy arrays using the angular spectrum approach</article-title>. <source>J Acoust Soc Am</source>. <year>2009</year>;<volume>125</volume>(<issue>5</issue>):<fpage>2967</fpage>-<lpage>77</lpage>.</citation>
</ref>
<ref id="bibr32-0161734612463847">
<label>32.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chen</surname><given-names>D</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>A 2D fast near-field method for calculating near-field pressures generated by apodized rectangular pistons</article-title>. <source>J Acoust Soc Am</source>. <year>2008</year>;<volume>124</volume>:<fpage>1526</fpage>-<lpage>37</lpage>.</citation>
</ref>
<ref id="bibr33-0161734612463847">
<label>33.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gomez</surname><given-names>F</given-names></name>
<name><surname>Althoefer</surname><given-names>K</given-names></name>
<name><surname>Seneviratne</surname><given-names>LD</given-names></name>
</person-group>. <article-title>An ultrasonic profiling method for the inspection of tubular structures</article-title>. <source>Comput Aided Civ Infrastruct Eng</source>. <year>2007</year>;<volume>22</volume>(<issue>6</issue>):<fpage>400</fpage>-<lpage>18</lpage>.</citation>
</ref>
<ref id="bibr34-0161734612463847">
<label>34.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gehrke</surname><given-names>T</given-names></name>
<name><surname>Cheikhrouhou</surname><given-names>F</given-names></name>
<name><surname>Overhoff</surname><given-names>HM</given-names></name>
</person-group>. <article-title>Derivation of the impulse response of ultrasonic transducers by experimental system identification</article-title>. <source>IEEE Ultrason Symp</source>. <year>2005</year>: <fpage>349</fpage>-<lpage>52</lpage>.</citation>
</ref>
<ref id="bibr35-0161734612463847">
<label>35.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>van Neer</surname><given-names>PLMJ</given-names></name>
<name><surname>Vos</surname><given-names>HJ</given-names></name>
<name><surname>de Jong</surname><given-names>N</given-names></name>
</person-group>. <article-title>Reflector-based phase calibration of ultrasound transducers</article-title>. <source>Ultrasonics</source>. <year>2011</year>;<volume>51</volume>(<issue>1</issue>):<fpage>1</fpage>-<lpage>6</lpage>.</citation>
</ref>
<ref id="bibr36-0161734612463847">
<label>36.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Olofsson</surname><given-names>T</given-names></name>
<name><surname>Stepinski</surname><given-names>T</given-names></name>
</person-group>. <article-title>Maximum a posteriori deconvolution of ultrasonic signals using multiple transducers</article-title>. <source>J Acoust Soc Am</source>. <year>2000</year>;<volume>107</volume>(<issue>6</issue>):<fpage>3276</fpage>-<lpage>88</lpage>.</citation>
</ref>
<ref id="bibr37-0161734612463847">
<label>37.</label>
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JA</given-names></name>
</person-group>. <article-title>User’s guide for the Field II program, release 3.20</article-title>. Available from: URL: <ext-link ext-link-type="uri" xlink:href="http://field-ii.dk/documents/users_guide.pdf">http://field-ii.dk/documents/users_guide.pdf</ext-link></citation>
</ref>
<ref id="bibr38-0161734612463847">
<label>38.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Denisenko</surname><given-names>N</given-names></name>
<name><surname>Scarano</surname><given-names>G</given-names></name>
<name><surname>Matteucci</surname><given-names>M</given-names></name>
<name><surname>Pappalardo</surname><given-names>M</given-names></name>
</person-group>. <article-title>An approximate solution of the transient acoustic field</article-title>. <source>IEEE Trans Ultrason Ferroelectrics Freq Contr</source>. <year>1985</year>;<volume>32</volume>(<issue>6</issue>):<fpage>821</fpage>-<lpage>7</lpage>.</citation>
</ref>
<ref id="bibr39-0161734612463847">
<label>39.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chen</surname><given-names>D</given-names></name>
<name><surname>Kelly</surname><given-names>JF</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>A fast nearfield method for calculations of time-harmonic and transient pressures produced by triangular pistons</article-title>. <source>J Acoust Soc Am</source>. <year>2006</year>;<volume>120</volume>(<issue>5</issue>):<fpage>2450</fpage>-<lpage>9</lpage>.</citation>
</ref>
<ref id="bibr40-0161734612463847">
<label>40.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Brigham</surname><given-names>EO</given-names></name>
<name><surname>Morrow</surname><given-names>RE</given-names></name>
</person-group>. <article-title>The fast Fourier transform</article-title>. <source>IEEE Spectrum</source>. <year>1967</year>;<volume>4</volume>(<issue>12</issue>):<fpage>63</fpage>-<lpage>70</lpage>.</citation>
</ref>
<ref id="bibr41-0161734612463847">
<label>41.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Frigo</surname><given-names>M</given-names></name>
<name><surname>Johnson</surname><given-names>SG</given-names></name>
</person-group>. <article-title>The design and implementation of FFTW3</article-title>. <source>Proceedings of the IEEE</source>. <year>2005</year>;<volume>93</volume>:<fpage>216</fpage>-<lpage>31</lpage>.</citation>
</ref>
<ref id="bibr42-0161734612463847">
<label>42.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kelly</surname><given-names>JF</given-names></name>
<name><surname>McGough</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>An annular superposition integral for axisymmetric radiators</article-title>. <source>J Acoust Soc Am</source>. <year>2007</year>;<volume>121</volume>:<fpage>759</fpage>-<lpage>65</lpage>.</citation>
</ref>
<ref id="bibr43-0161734612463847">
<label>43.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JA</given-names></name>
</person-group>. <article-title>A model for the propagation and scattering of ultrasound in tissue</article-title>. <source>J Acoust Soc Am</source>. <year>1991</year>;<volume>89</volume>(<issue>1</issue>):<fpage>182</fpage>-<lpage>90</lpage>.</citation>
</ref>
<ref id="bibr44-0161734612463847">
<label>44.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Li</surname><given-names>YD</given-names></name>
<name><surname>Zagzebski</surname><given-names>JA</given-names></name>
</person-group>. <article-title>A frequency domain model for generating B-mode images with array transducers</article-title>. <source>IEEE Trans Ultrason Ferroelect Freq Contr</source>. <year>1999</year>;<volume>46</volume>(<issue>3</issue>):<fpage>690</fpage>-<lpage>9</lpage>.</citation>
</ref>
<ref id="bibr45-0161734612463847">
<label>45.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Mast</surname><given-names>TD</given-names></name>
</person-group>. <article-title>Convolutional modeling of diffraction effects in pulse-echo ultrasound imaging</article-title>. <source>J Acoust Soc Am</source>. <year>2010</year>;<volume>128</volume>(<issue>3</issue>):<fpage>EL99</fpage>-<lpage>104</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>